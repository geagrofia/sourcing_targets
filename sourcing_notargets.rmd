---
title: "Sourcing - TZA Cotton"
author: "A Farrow"
date: "`r Sys.Date()`"
header-includes:
   - \usepackage[default]{sourcesanspro}
   - \usepackage[T1]{fontenc}
   - \usepackage{float}
   - \pagenumbering{gobble}
mainfont: SourceSansPro
output:
  pdf_document:
    dev: png
fontsize: 12pt
papersize: a4
classoption: landscape
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(collapse = TRUE, comment = "#>",  dpi = 300,
  echo = FALSE,
  results = 'hide' ,
  message = FALSE,
  warning = FALSE)
```

```{r initialise01, cache = FALSE, echo=FALSE, message=FALSE, warning=FALSE}

# initialisation
  library(tidyverse)
  library(tidyterra)
  library(dplyr)
  library(rnaturalearth)
  library(sf)
  library(terra)
  library(rasterVis)
  library(exactextractr)
  library(scales)
  library(irm)
  library(fuZR)
  library(kableExtra)
  library(units)
  library(magrittr)
  library(geodata)
  library(here)
  library(knitr)

```

```{r initialise02, echo=FALSE, message=FALSE, warning=FALSE}

r_filename <- function(filename) {
  here::here("R/", filename)
}

source(r_filename("functions.R"))

```

# Parameters

Many parameters are defined in the cc_data file. We load this here.

```{r parameters, echo=FALSE, message=FALSE, warning=FALSE}

cc_row <- 15

```

```{r raw_data, echo=FALSE, message=FALSE, warning=FALSE, results = 'show'}

cc_data_path <-  paste("data/cc_data.csv")
cc_data <-   read_csv(cc_data_path, col_types = cols())
cc_data_kable <-  cc_data_kable_make_f(cc_data)
ISO <-  ISO_get_f(cc_data, cc_row)
crop <-  crop_get_f(cc_data, cc_row)
drought <-  drought_get_f(cc_data, cc_row)
heat <-  heat_get_f(cc_data, cc_row)
flood <-  flood_get_f(cc_data, cc_row)
  
drought_threshold_l <-  drought_threshold_l_get_f(cc_data, cc_row)
drought_threshold_l_width <-  drought_threshold_l_width_get_f(cc_data, cc_row)
drought_threshold_u <-  drought_threshold_u_get_f(cc_data, cc_row)
drought_threshold_u_width <-  drought_threshold_u_width_get_f(cc_data, cc_row)

heat_threshold_l <-  heat_threshold_l_get_f(cc_data, cc_row)
heat_threshold_l_width <-  heat_threshold_l_width_get_f(cc_data, cc_row)
heat_threshold_u <-  heat_threshold_u_get_f(cc_data, cc_row)
heat_threshold_u_width <-  heat_threshold_u_width_get_f(cc_data ,  cc_row)

flood_threshold_l <-  flood_threshold_l_get_f(cc_data, cc_row)
flood_threshold_l_width <-  flood_threshold_l_width_get_f(cc_data, cc_row)
flood_threshold_u <-  flood_threshold_u_get_f(cc_data, cc_row)
flood_threshold_u_width <-  flood_threshold_u_width_get_f(cc_data, cc_row)

crasa_params <- enframe(c(drought_threshold_l = drought_threshold_l, drought_threshold_l_width = drought_threshold_l_width, drought_threshold_u = drought_threshold_u, drought_threshold_u_width = drought_threshold_u_width, heat_threshold_l =  heat_threshold_l, heat_threshold_l_width = heat_threshold_l_width, heat_threshold_u = heat_threshold_u, heat_threshold_u_width = heat_threshold_u_width, flood_threshold_l = flood_threshold_l, flood_threshold_l_width =  flood_threshold_l_width, flood_threshold_u = flood_threshold_u, flood_threshold_u_width = flood_threshold_u_width)) %>% knitr::kable() %>%    kable_styling(latex_options = c("striped", "hold_position"), font_size = 9)

aggregation_value <-  aggregation_value_get_f(cc_data, cc_row)
aggregation_value_pot <-  aggregation_value_pot_get_f(cc_data, cc_row)

```

```{r, echo=FALSE,  fig.align = "center", fig.pos = "H", message=FALSE, warning=FALSE, results = 'show'}

cat("Country = ", ISO)
cat("Crop = ", crop)
cat("Drought = ", drought)
cat("Heat = ", heat)
cat("Flood = ", flood)
cat("Aggregation_value = ", aggregation_value)
 
crasa_params  

```

# Global spatial data

Global country boundaries just used for background in the plots.

```{r global_spatial_data, echo=FALSE, message=FALSE, warning=FALSE}

world <- ne_countries(scale = "medium", returnclass = "sf")
  
world_plot <- world_plot_f(world)

```

# Country spatial data

Spatial data sets that are specific to the country.

```{r country_crop_data_a, echo=FALSE, message=FALSE, warning=FALSE}

vect_crop <- vect_crop_get_f(cc_data, cc_row)

```

```{r country_crop_data_b, echo=FALSE, message=FALSE, warning=FALSE}

```

## Crop area polygons

This is the information we have on the sourcing areas for this crop.

```{r country_crop_data_c, echo=FALSE, message=FALSE, warning=FALSE}

vect_crop_plot <- vect_crop_plot_f(vect_crop, ISO, crop, world)

```

```{r, message = FALSE, fig.width = 8, fig.height = 6}

vect_crop_plot

```

## GADM Country boundary polygons

```{r country_crop_data_d, echo=FALSE, message=FALSE, warning=FALSE}

GADM_query0 <- GADM_query0_make_f(ISO)
vect_ISO <- vect_ISO_get_f(GADM_query0)

```

```{r country_crop_data_e, echo=FALSE, message=FALSE, warning=FALSE}

GADM_query1 <- GADM_query1_make_f(ISO)
vect_ISO1 <- vect_ISO1_get_f(cc_data, cc_row, GADM_query1)

```

```{r country_crop_data_f, echo=FALSE, message=FALSE, warning=FALSE}

vect_ISO_extent <- vect_ISO_extent_f(vect_ISO)

```

```{r country_crop_data_g, echo=FALSE, message=FALSE, warning=FALSE}

vect_ISO_plot <- vect_ISO_plot_f(vect_ISO, ISO)

```

```{r, message = FALSE, fig.width = 8, fig.height = 6}

vect_ISO_plot

```

# Land Cover Map in an African context

Global land cover is cropped to the extent of the country.

```{r country_crop_data_h , echo=FALSE, message=FALSE, warning=FALSE}

rast_clim_mask <- rast_clim_mask_get_f(ISO)

```

```{r country_crop_data_ii, echo=FALSE, message=FALSE, warning=FALSE}

rast_lc_global <- rast_lc_global_get_f(rast_clim_mask, cc_data, cc_row)

```


```{r country_crop_data_iii, echo=FALSE, message=FALSE, warning=FALSE}

rast_lc_potential <- rast_lc_potential_get_f(rast_clim_mask, cc_data, cc_row)

```


```{r country_crop_data_ji, echo=FALSE, message=FALSE, warning=FALSE}

rast_lc_file <- rast_lc_make_write_f(rast_lc_global, aggregation_value, vect_ISO, ISO)

```

```{r country_crop_data_jii, echo=FALSE, message=FALSE, warning=FALSE}

rast_lc_pot_file <- rast_lc_pot_make_write_f(rast_lc_potential, aggregation_value_pot, vect_ISO, ISO)

```

```{r country_crop_data_ki, echo=FALSE, message=FALSE, warning=FALSE}

rast_lc <- rast_lc_get_f(rast_lc_file, ISO)

```

```{r country_crop_data_kii, echo=FALSE, message=FALSE, warning=FALSE}

rast_lc_pot <- rast_lc_pot_get_f(rast_lc_pot_file, ISO)

```

```{r country_crop_data_li, echo=FALSE, message=FALSE, warning=FALSE}

rast_lc_plot <- rast_lc_plot_f(rast_lc, world)

```

```{r country_crop_data_lii, echo=FALSE, message=FALSE, warning=FALSE}

rast_lc_pot_plot <- rast_lc_pot_plot_f(rast_lc_pot, world)

```

```{r, message = FALSE, fig.width = 8, fig.height = 6}
rast_lc_plot
```

```{r, message = FALSE, fig.width = 8, fig.height = 6}
rast_lc_pot_plot
```

# Spatial data preparation

```{r spatial_data_prep_processing_1ai, echo=FALSE, message=FALSE, warning=FALSE}

rast_ISO_a_file <- rast_ISO_a_make_write_f(vect_ISO, rast_lc, ISO)
rast_ISO_a <- rast_ISO_a_get_f(ISO, rast_ISO_a_file)

```

```{r spatial_data_prep_processing_1aii, echo=FALSE, message=FALSE, warning=FALSE}

rast_ISO_a_pot_file <- rast_ISO_a_pot_make_write_f(vect_ISO, rast_lc_pot, ISO)
rast_ISO_a_pot <- rast_ISO_a_pot_get_f(ISO, rast_ISO_a_pot_file)

```

```{r spatial_data_prep_processing_1aiii, echo=FALSE, message=FALSE, warning=FALSE}

rast_ISO_file <- rast_ISO_make_write_f(rast_ISO_a, vect_ISO, ISO)
rast_ISO_pot_file <- rast_ISO_pot_make_write_f(rast_ISO_a_pot, vect_ISO, ISO)

```

```{r spatial_data_prep_processing_1aiv, echo=FALSE, message=FALSE, warning=FALSE}

rast_ISO <- rast_ISO_get_f(ISO, rast_ISO_file)
rast_ISO_pot <- rast_ISO_pot_get_f(ISO, rast_ISO_pot_file)

```

```{r spatial_data_prep_processing_1bi, echo=FALSE, message=FALSE, warning=FALSE}

rast_lc_ISO_file <- rast_lc_ISO_make_write_f(rast_lc, rast_ISO, ISO)
rast_lc_ISO_pot_file <- rast_lc_ISO_pot_make_write_f(rast_lc_pot, rast_ISO_pot, ISO)
vect_lc_ISO_file <- vect_lc_ISO_make_write_f(rast_lc, rast_ISO,  ISO)

```

```{r spatial_data_prep_processing_1bii, echo=FALSE, message=FALSE, warning=FALSE}

rast_lc_ISO <- rast_lc_ISO_get_f(ISO, rast_lc_ISO_file)
rast_lc_ISO_pot <- rast_lc_ISO_pot_get_f(ISO, rast_lc_ISO_pot_file)

```

```{r spatial_data_prep_processing_2a, echo=FALSE, message=FALSE, warning=FALSE}

rast_crop_file <- rast_crop_make_write_f(vect_crop, rast_lc_ISO, ISO, crop)
rast_crop_pot_file <- rast_crop_pot_make_write_f(vect_crop, rast_lc_ISO_pot, ISO, crop)

```

```{r spatial_data_prep_processing_2b, echo=FALSE, message=FALSE, warning=FALSE}

rast_crop <- rast_crop_get_f(rast_crop_file, ISO, crop)
rast_crop_pot <- rast_crop_pot_get_f(rast_crop_pot_file, ISO, crop)

```

```{r spatial_data_prep_processing_2c, echo=FALSE, message=FALSE, warning=FALSE}

rast_crop_ISO_file <- rast_crop_ISO_make_write_f(rast_crop, rast_ISO, ISO, crop)
rast_crop_ISO_pot_file <- rast_crop_ISO_pot_make_write_f(rast_crop_pot, rast_ISO_pot, ISO, crop)
  
```

```{r spatial_data_prep_processing_2d, echo=FALSE, message=FALSE, warning=FALSE}

rast_crop_ISO <- rast_crop_ISO_get_f(rast_crop_ISO_file, ISO, crop)
rast_crop_ISO_pot <- rast_crop_ISO_pot_get_f(rast_crop_ISO_pot_file, ISO, crop)

```

```{r spatial_data_prep_processing_3a, echo=FALSE, message=FALSE, warning=FALSE}

rast_crop_ISO_lc_file <- rast_crop_ISO_lc_file_make_write_f(rast_lc_ISO, rast_crop_ISO, ISO, crop)
rast_crop_ISO_lc_pot_file <- rast_crop_ISO_lc_pot_file_make_write_f(rast_lc_ISO_pot, rast_crop_ISO_pot, ISO, crop)

```

```{r spatial_data_prep_processing_3b, echo=FALSE, message=FALSE, warning=FALSE}

rast_crop_ISO_lc <-  rast_crop_ISO_lc_get_f(rast_crop_ISO_lc_file, ISO, crop)
rast_crop_ISO_lc_pot <-  rast_crop_ISO_lc_pot_get_f(rast_crop_ISO_lc_pot_file, ISO, crop)
  
```

```{r spatial_data_prep_processing_3c, echo=FALSE, message=FALSE, warning=FALSE}

rast_crop_ISO_lc_rcl_file <- rast_crop_ISO_lc_rcl_make_write_f(rast_crop_ISO_lc, ISO, crop)
rast_crop_ISO_lc_rcl_pot_file <- rast_crop_ISO_lc_rcl_pot_make_write_f(rast_crop_ISO_lc_pot, ISO, crop)

```

```{r spatial_data_prep_processing_3d, echo=FALSE, message=FALSE, warning=FALSE}

rast_crop_ISO_lc_rcl <- rast_crop_ISO_lc_rcl_get_f(rast_crop_ISO_lc_rcl_file, ISO, crop)
rast_crop_ISO_lc_rcl_pot <- rast_crop_ISO_lc_rcl_pot_get_f(rast_crop_ISO_lc_rcl_pot_file, ISO, crop)
  
```

```{r spatial_data_prep_processing_4ai, echo=FALSE, message=FALSE, warning=FALSE}

rast_crop_ISO_lc_rcl_combined_file  <- rast_crop_ISO_lc_rcl_combined_make_write_f(rast_crop_ISO_lc_rcl, rast_crop_ISO_lc_rcl_pot, ISO, crop)
# rast_crop_ISO_lc_rcl_combined_pot_file  <- rast_crop_ISO_lc_rcl_combined_pot_make_write_f(rast_crop_ISO_lc_rcl_pot, ISO, crop)

```

```{r spatial_data_prep_processing_4aii, echo=FALSE, message=FALSE, warning=FALSE}

rast_crop_ISO_lc_rcl_combined  <- rast_crop_ISO_lc_rcl_combined_get_f(rast_crop_ISO_lc_rcl_combined_file, ISO, crop)
# rast_crop_ISO_lc_rcl_combined_pot  <- rast_crop_ISO_lc_rcl_combined_pot_get_f(rast_crop_ISO_lc_rcl_combined_pot_file, ISO, crop)

```

```{r spatial_data_prep_processing_4b, echo=FALSE, message=FALSE, warning=FALSE}
  
rast_crop_ISO_lc_rcl_combined_values  <- rast_crop_ISO_lc_rcl_combined_values_get_f(rast_crop_ISO_lc_rcl_combined)

# rast_crop_ISO_lc_rcl_combined_values_pot  <- rast_crop_ISO_lc_rcl_combined_values_pot_get_f(rast_crop_ISO_lc_rcl_combined_pot)

rast_crop_ISO_lc_rcl_combined_values_vec0  <- c(0)
rast_crop_ISO_lc_rcl_combined_values_vec1  <- c(1)
rast_crop_ISO_lc_rcl_combined_values_vec2  <- c(2)
rast_crop_ISO_lc_rcl_combined_values_vec01  <- c(0, 1)
rast_crop_ISO_lc_rcl_combined_values_vec02  <- c(0, 2)
rast_crop_ISO_lc_rcl_combined_values_vec12  <- c(1, 2)

```


```{r spatial_data_prep_processing_4bi, echo=FALSE, message=FALSE, warning=FALSE}





```



```{r spatial_data_prep_processing_4c, echo=FALSE, message=FALSE, warning=FALSE}

vect_crop_ISO_lc_rcl_combined_file1  <- vect_crop_ISO_lc_rcl_combined1_make_write_f(rast_crop_ISO_lc_rcl_combined,  ISO, crop)

# vect_crop_ISO_lc_rcl_combined_pot_file1  <- vect_crop_ISO_lc_rcl_combined1_pot_make_write_f(rast_crop_ISO_lc_rcl_combined_pot,  ISO, crop)

```

```{r spatial_data_prep_processing_5a, echo=FALSE, message=FALSE, warning=FALSE}

vect_crop_ISO_lc_rcl_combined  <-  vect_crop_ISO_lc_rcl_combined_get_f(
    vect_crop_ISO_lc_rcl_combined_file1,
    rast_crop_ISO_lc_rcl_combined_values,
    rast_crop_ISO_lc_rcl_combined_values_vec0,
    rast_crop_ISO_lc_rcl_combined_values_vec1,
    rast_crop_ISO_lc_rcl_combined_values_vec2,
    rast_crop_ISO_lc_rcl_combined_values_vec01,
    rast_crop_ISO_lc_rcl_combined_values_vec02,
    rast_crop_ISO_lc_rcl_combined_values_vec12,
    ISO,
    crop,
    vect_ISO1
  )

# vect_crop_ISO_lc_rcl_combined_pot  <-  vect_crop_ISO_lc_rcl_combined_pot_get_f(
#     vect_crop_ISO_lc_rcl_combined_file1_pot,
#     rast_crop_ISO_lc_rcl_combined_values_pot,
#     rast_crop_ISO_lc_rcl_combined_values_vec0,
#     rast_crop_ISO_lc_rcl_combined_values_vec1,
#     rast_crop_ISO_lc_rcl_combined_values_vec2,
#     rast_crop_ISO_lc_rcl_combined_values_vec01,
#     rast_crop_ISO_lc_rcl_combined_values_vec02,
#     rast_crop_ISO_lc_rcl_combined_values_vec12,
#     ISO,
#     crop,
#     vect_ISO1
#   )

```

```{r spatial_data_prep_processing_5b, echo=FALSE, message=FALSE, warning=FALSE}

vect_crop_ISO_lc_rcl_combined_file2  <- vect_crop_ISO_lc_rcl_combined2_make_write_f (vect_crop_ISO_lc_rcl_combined,  ISO, crop)

# vect_crop_ISO_lc_rcl_combined_file2_pot  <- vect_crop_ISO_lc_rcl_combined2_pot_make_write_f (vect_crop_ISO_lc_rcl_combined_pot,  ISO, crop)

```

## Project the crop/landuse vector and get area stats

```{r spatial_data_prep_processing_6, echo=FALSE, message=FALSE, warning=FALSE}


wkt_lam  <- wkt_lam_make_f(vect_ISO)
crs_lam  <- crs_lam_make_f(wkt_lam)

vect_crop_ISO_lc_rcl_combined_proj_file  <- vect_crop_ISO_lc_rcl_combined_proj_file_make_write_f(vect_crop_ISO_lc_rcl_combined, crs_lam, ISO, crop)

# vect_crop_ISO_lc_rcl_combined_proj_pot_file  <- vect_crop_ISO_lc_rcl_combined_proj_pot_file_make_write_f(vect_crop_ISO_lc_rcl_combined_pot, crs_lam, ISO, crop)

vect_crop_ISO_lc_rcl_combined_proj  <- vect_crop_ISO_lc_rcl_combined_proj_get_f(vect_crop_ISO_lc_rcl_combined_proj_file, ISO, crop)

# vect_crop_ISO_lc_rcl_combined_proj_pot  <- vect_crop_ISO_lc_rcl_combined_proj_pot_get_f(vect_crop_ISO_lc_rcl_combined_proj_pot_file, ISO, crop)

dB_crop_ISO_lc_rcl_combined_proj  <- dB_crop_ISO_lc_rcl_combined_proj_make_f(vect_crop_ISO_lc_rcl_combined_proj, vect_ISO1, ISO, crop)
# 
# dB_crop_ISO_lc_rcl_combined_proj_pot  <- dB_crop_ISO_lc_rcl_combined_proj_pot_make_f(vect_crop_ISO_lc_rcl_combined_proj_pot, vect_ISO1, ISO, crop)

dB_crop_ISO_lc_rcl_combined_proj_plot <- dB_crop_ISO_lc_rcl_combined_proj_plot_f(dB_crop_ISO_lc_rcl_combined_proj)

# dB_crop_ISO_lc_rcl_combined_proj_pot_plot <- dB_crop_ISO_lc_rcl_combined_proj_pot_plot_f(dB_crop_ISO_lc_rcl_combined_proj_pot)

```

```{r, message = FALSE, results = 'show'}

cat("Projection = ", wkt_lam)

```

```{r, message = FALSE, fig.width = 8, fig.height = 6}

dB_crop_ISO_lc_rcl_combined_proj_plot
# dB_crop_ISO_lc_rcl_combined_proj_pot_plot

```

## Land cover clipped to country boundary

```{r spatial_data_prep_plots_a,  echo=FALSE, message=FALSE, warning=FALSE}
 
rast_lc_ISO_plot <- rast_lc_ISO_plot_f(rast_lc_ISO, world, vect_ISO, ISO)
# rast_lc_ISO_pot_plot <- rast_lc_ISO_pot_plot_f(rast_lc_ISO_pot, world, vect_ISO, ISO)

```

```{r, message = FALSE, fig.width = 8, fig.height = 6}

rast_lc_ISO_plot
# rast_lc_ISO_pot_plot
```

## Crop area converted to raster and clipped to country boundary

```{r spatial_data_prep_plots_b,  echo=FALSE, message=FALSE, warning=FALSE}

rast_crop_ISO_plot <- rast_crop_ISO_plot_f(rast_crop_ISO, vect_ISO1, ISO, crop)
# rast_crop_ISO_pot_plot <- rast_crop_ISO_pot_plot_f(rast_crop_ISO_pot, vect_ISO1, ISO, crop)

```

```{r, message = FALSE, fig.width = 8, fig.height = 6}

rast_crop_ISO_plot
# rast_crop_ISO_pot_plot

```

## Crop area raster combined with Land cover

```{r spatial_data_prep_plots_c, echo=FALSE, message=FALSE, warning=FALSE}

rast_crop_ISO_lc_plot <- rast_crop_ISO_lc_plot_f(rast_crop_ISO_lc, vect_ISO1, ISO, crop)
# rast_crop_ISO_lc_pot_plot <- rast_crop_ISO_lc_pot_plot_f(rast_crop_ISO_lc_pot, vect_ISO1, ISO, crop)

```

```{r, message = FALSE, fig.width = 8, fig.height = 6}

rast_crop_ISO_lc_plot
# rast_crop_ISO_lc_pot_plot

```

## Crop area and Land cover raster reclassified

```{r spatial_data_prep_plots_d, echo=FALSE, message=FALSE, warning=FALSE}

rast_crop_ISO_lc_rcl_plot <- rast_crop_ISO_lc_rcl_plot_f(rast_crop_ISO_lc_rcl, vect_ISO1, ISO, crop)
# rast_crop_ISO_lc_rcl_pot_plot <- rast_crop_ISO_lc_rcl_pot_plot_f(rast_crop_ISO_lc_rcl_pot, vect_ISO1, ISO, crop)

```

```{r, message = FALSE, fig.width = 8, fig.height = 6}

rast_crop_ISO_lc_rcl_plot
# rast_crop_ISO_lc_rcl_pot_plot

```

## Join the current sourcing area with the potential sourcing area


```{r, message = FALSE, fig.width = 8, fig.height = 6}



```

## Reclassified crop area and Land cover raster aggregated

```{r spatial_data_prep_plots_e, results = 'asis', echo=FALSE, message=FALSE, warning=FALSE}

vect_crop_ISO_lc_rcl_combined_plot <- vect_crop_ISO_lc_rcl_combined_plot_f(vect_crop_ISO_lc_rcl_combined, vect_ISO1, ISO, crop)
# vect_crop_ISO_lc_rcl_combined_pot_plot <- vect_crop_ISO_lc_rcl_combined_pot_plot_f(vect_crop_ISO_lc_rcl_combined_pot, vect_ISO1, ISO, crop)

vect_crop_ISO_lc_rcl_combined_plot

```

```{r, message = FALSE, fig.width = 8, fig.height = 6}


exit_early <- exit_early_f(vect_crop_ISO_lc_rcl_combined)
exit_early
# vect_crop_ISO_lc_rcl_combined_pot_plot

```

# Climate Base Data

## Load original data trim and save

```{r trimmed_climate_mask, echo=FALSE, message=FALSE, warning=FALSE}
 
rast_clim_mask_trim_file  <- rast_clim_mask_trim_file_make_write_f(vect_ISO, rast_clim_mask, ISO)

rast_clim_mask_trim  <- rast_clim_mask_trim_get_f(ISO, rast_clim_mask_trim_file)

```

```{r climate_base_data_trim_1, echo=FALSE, message=FALSE, warning=FALSE}
 
rast_rainfallc_file  <- rast_rainfallc_make_write_f(ISO, crop, cc_data, cc_row, rast_clim_mask_trim)

rast_rainfallf_file  <- rast_rainfallf_make_write_f(ISO, crop, cc_data, cc_row, rast_clim_mask_trim)

rast_tempc_file  <- rast_tempc_make_write_f(ISO, crop, cc_data, cc_row, rast_clim_mask_trim)

rast_tempf_file  <- rast_tempf_make_write_f(ISO, crop, cc_data, cc_row, rast_clim_mask_trim)

```

```{r climate_base_data_trim_2, echo=FALSE, message=FALSE, warning=FALSE}
 
rast_onsetc_file  <- rast_onsetc_make_write_f(ISO, crop, cc_data, cc_row, rast_clim_mask_trim)
                                                 
rast_onsetf_file  <- rast_onsetf_make_write_f(ISO, crop, cc_data, cc_row, rast_clim_mask_trim)
                                                 
rast_durationc_file  <- rast_durationc_make_write_f(ISO, crop, cc_data, cc_row, rast_clim_mask_trim)
                                                       
rast_durationf_file  <- rast_durationf_make_write_f(ISO, crop, cc_data, cc_row, rast_clim_mask_trim)
   
```

```{r climate_base_data_get_1, echo=FALSE, message=FALSE, warning=FALSE}
 
rast_rainfallc  <- rast_rainfallc_get_f(ISO, crop, rast_rainfallc_file)

rast_rainfallf  <- rast_rainfallf_get_f(ISO, crop, rast_rainfallf_file)
   
rast_tempc  <- rast_tempc_get_f(ISO, crop, rast_tempc_file)
   
rast_tempf  <- rast_tempf_get_f(ISO, crop, rast_tempf_file)

```

```{r climate_base_data_get_2, echo=FALSE, message=FALSE, warning=FALSE}
 
rast_onsetc  <- rast_onsetc_get_f(ISO, crop, rast_onsetc_file)

rast_onsetf  <- rast_onsetf_get_f(ISO, crop, rast_onsetf_file)

rast_durationc  <- rast_durationc_get_f(ISO, crop, rast_durationc_file)

rast_durationf  <- rast_durationf_get_f(ISO, crop, rast_durationf_file)

```

## Calculate changes and save

```{r climate_base_data_changes_make, echo=FALSE, message=FALSE, warning=FALSE}

rast_rainfall_change_file  <- rast_rainfall_change_make_write_f(rast_rainfallc, rast_rainfallf, ISO, crop)
                                                                
rast_temp_change_file  <- rast_temp_change_make_write_f(rast_tempc, rast_tempf, ISO, crop)
                                                           
rast_onset_change_file  <- rast_onset_change_make_write_f(rast_onsetc, rast_onsetf, ISO, crop)
                                                             
rast_duration_change_file  <- rast_duration_change_make_write_f(rast_durationc, rast_durationf, ISO, crop)
   
```

```{r climate_base_data_changes_get, echo=FALSE, message=FALSE, warning=FALSE}

rast_rainfall_change  <- rast_rainfall_change_get_f(rast_rainfall_change_file, ISO, crop)

rast_temp_change  <- rast_temp_change_get_f(rast_temp_change_file, ISO, crop)

rast_onset_change  <- rast_onset_change_get_f(rast_onset_change_file, ISO, crop)
                                                                                        rast_duration_change  <- rast_duration_change_get_f(rast_duration_change_file, ISO, crop)

```

### Rainfall

\newpage

```{r climate_base_data_plot_1, echo=FALSE, message=FALSE, warning=FALSE}


rast_rainfallc_plot <- rast_rainfallc_plot_f(rast_rainfallc,
                      vect_ISO1,
                      vect_crop_ISO_lc_rcl_combined,
                      vect_ISO,
                      world,
                      ISO,
                      crop)
rast_rainfallf_plot <- rast_rainfallf_plot_f(rast_rainfallf,
                      vect_ISO1,
                      vect_crop_ISO_lc_rcl_combined,
                      vect_ISO,
                      world,
                      ISO,
                      crop)

rast_rainfall_change_plot <- rast_rainfall_change_plot_f(
  rast_rainfall_change,
  vect_ISO1,
  vect_crop_ISO_lc_rcl_combined,
  vect_ISO,
  world,
  ISO,
  crop
)


```

```{r, message = FALSE, fig.width = 8, fig.height = 6}

rast_rainfallc_plot

```

```{r, message = FALSE, fig.width = 8, fig.height = 6}

rast_rainfallf_plot

```

```{r, message = FALSE, fig.width = 8, fig.height = 6}

rast_rainfall_change_plot

```

### Temperature

\newpage

```{r climate_base_data_plot_2, echo=FALSE, message=FALSE, warning=FALSE}
rast_tempc_plot <- rast_tempc_plot_f(rast_tempc,
                  vect_ISO1,
                  vect_crop_ISO_lc_rcl_combined,
                  vect_ISO,
                  world,
                  ISO,
                  crop)
rast_tempf_plot <- rast_tempf_plot_f(rast_tempf,
                  vect_ISO1,
                  vect_crop_ISO_lc_rcl_combined,
                  vect_ISO,
                  world,
                  ISO,
                  crop)

rast_temp_change_plot <- rast_temp_change_plot_f(rast_temp_change,
                        vect_ISO1,
                        vect_crop_ISO_lc_rcl_combined,
                        vect_ISO,
                        world,
                        ISO,
                        crop)

```

```{r, message = FALSE, fig.width = 8, fig.height = 6}

rast_tempc_plot

```

```{r, message = FALSE, fig.width = 8, fig.height = 6}

rast_tempf_plot

```

```{r, message = FALSE, fig.width = 8, fig.height = 6}

rast_temp_change_plot

```

### Season Onset

\newpage

```{r climate_base_data_plot_3, echo=FALSE, message=FALSE, warning=FALSE}
 
rast_onsetc_plot <- rast_onsetc_plot_f(rast_onsetc,
                   vect_ISO1,
                   vect_crop_ISO_lc_rcl_combined,
                   vect_ISO,
                   world,
                   ISO,
                   crop)
rast_onsetf_plot <- rast_onsetf_plot_f(rast_onsetf,
                   vect_ISO1,
                   vect_crop_ISO_lc_rcl_combined,
                   vect_ISO,
                   world,
                   ISO,
                   crop)

rast_onset_change_plot <- rast_onset_change_plot_f(rast_onset_change,
                         vect_ISO1,
                         vect_crop_ISO_lc_rcl_combined,
                         vect_ISO,
                         world,
                         ISO,
                         crop)

```

```{r, message = FALSE, fig.width = 8, fig.height = 6}

rast_onsetc_plot

```

```{r, message = FALSE, fig.width = 8, fig.height = 6}

rast_onsetf_plot

```

```{r, message = FALSE, fig.width = 8, fig.height = 6}

rast_onset_change_plot

```

### Season Duration

\newpage

```{r climate_base_data_plot_4, echo=FALSE, message=FALSE, warning=FALSE}
 
rast_durationc_plot<- rast_durationc_plot_f(rast_durationc,
                      vect_ISO1,
                      vect_crop_ISO_lc_rcl_combined,
                      vect_ISO,
                      world,
                      ISO,
                      crop)

rast_durationf_plot <- rast_durationf_plot_f(rast_durationf,
                      vect_ISO1,
                      vect_crop_ISO_lc_rcl_combined,
                      vect_ISO,
                      world,
                      ISO,
                      crop)

rast_duration_change_plot <- rast_duration_change_plot_f(
  rast_duration_change,
  vect_ISO1,
  vect_crop_ISO_lc_rcl_combined,
  vect_ISO,
  world,
  ISO,
  crop
)


```

```{r, message = FALSE, fig.width = 8, fig.height = 6}

rast_durationc_plot

```

```{r, message = FALSE, fig.width = 8, fig.height = 6}

rast_durationf_plot

```

```{r, message = FALSE, fig.width = 8, fig.height = 6}

rast_duration_change_plot

```

# Climate Hazard Indicator Data

## Load original data trim and save

```{r climate_hazard_data_trim, echo=FALSE, message=FALSE, warning=FALSE}


rast_droughtc_file <-
  rast_droughtc_make_write_f(ISO, crop, cc_data, cc_row, rast_clim_mask_trim)
rast_droughtf_file <-
  rast_droughtf_make_write_f(ISO, crop, cc_data, cc_row, rast_clim_mask_trim)
rast_heatc_file <-
  rast_heatc_make_write_f(ISO, crop, cc_data, cc_row, rast_clim_mask_trim)
rast_heatf_file <-
  rast_heatf_make_write_f(ISO, crop, cc_data, cc_row, rast_clim_mask_trim)
rast_floodc_file <-
  rast_floodc_make_write_f(ISO, crop, cc_data, cc_row, rast_clim_mask_trim)
rast_floodf_file <-
  rast_floodf_make_write_f(ISO, crop, cc_data, cc_row, rast_clim_mask_trim)

```

```{r climate_hazard_data_get, echo=FALSE, message=FALSE, warning=FALSE}


rast_droughtc <-
  rast_droughtc_get_f(ISO, crop, rast_droughtc_file)
rast_droughtf <-
  rast_droughtf_get_f(ISO, crop, rast_droughtf_file)
rast_heatc <- rast_heatc_get_f(ISO, crop, rast_heatc_file)
rast_heatf <- rast_heatf_get_f(ISO, crop, rast_heatf_file)
rast_floodc <- rast_floodc_get_f(ISO, crop, rast_floodc_file)
rast_floodf <- rast_floodf_get_f(ISO, crop, rast_floodf_file)

```

### Calculate changes and save

```{r climate_hazard_changes_make, echo=FALSE, message=FALSE, warning=FALSE}



rast_drought_change_file <-
  rast_drought_change_make_write_f(rast_droughtc, rast_droughtf, ISO, crop)


rast_heat_change_file <-
  rast_heat_change_make_write_f(rast_heatc, rast_heatf, ISO, crop)


rast_flood_change_file <-
  rast_flood_change_make_write_f(rast_floodc, rast_floodf, ISO, crop)

```

```{r climate_hazard_changes_get, echo=FALSE, message=FALSE, warning=FALSE}


rast_drought_change <-
  rast_drought_change_get_f(rast_drought_change_file, ISO, crop)


rast_heat_change <-
  rast_heat_change_get_f(rast_heat_change_file, ISO, crop)


rast_flood_change <-
  rast_flood_change_get_f(rast_flood_change_file, ISO, crop)

```

### Drought

\newpage

```{r climate_hazard_data_plot_1, echo=FALSE, message=FALSE, warning=FALSE}

rast_droughtc_plot <- rast_droughtc_plot_f(
  rast_droughtc,
  vect_ISO1,
  vect_crop_ISO_lc_rcl_combined,
  vect_ISO,
  world,
  ISO,
  crop,
  drought
)

rast_droughtf_plot <- rast_droughtf_plot_f(
  rast_droughtf,
  vect_ISO1,
  vect_crop_ISO_lc_rcl_combined,
  vect_ISO,
  world,
  ISO,
  crop,
  drought
)

rast_drought_change_plot <- rast_drought_change_plot_f(
  rast_drought_change,
  vect_ISO1,
  vect_crop_ISO_lc_rcl_combined,
  vect_ISO,
  world,
  ISO,
  crop,
  drought
)
```


```{r, message = FALSE, fig.width = 8, fig.height = 6}

rast_droughtc_plot

```

```{r, message = FALSE, fig.width = 8, fig.height = 6}

rast_droughtf_plot

```

```{r, message = FALSE, fig.width = 8, fig.height = 6}

rast_drought_change_plot

```

### Heat Stress

\newpage

```{r climate_hazard_data_plot_2, echo=FALSE, message=FALSE, warning=FALSE}

rast_heatc_plot <- rast_heatc_plot_f(rast_heatc,
                  vect_ISO1,
                  vect_crop_ISO_lc_rcl_combined,
                  vect_ISO,
                  world,
                  ISO,
                  crop,
                  heat)

rast_heatf_plot <- rast_heatf_plot_f(rast_heatf,
                  vect_ISO1,
                  vect_crop_ISO_lc_rcl_combined,
                  vect_ISO,
                  world,
                  ISO,
                  crop,
                  heat)

rast_heat_change_plot<- rast_heat_change_plot_f(
  rast_heat_change,
  vect_ISO1,
  vect_crop_ISO_lc_rcl_combined,
  vect_ISO,
  world,
  ISO,
  crop,
  heat
)
```

```{r, message = FALSE, fig.width = 8, fig.height = 6}

rast_heatc_plot

```

```{r, message = FALSE, fig.width = 8, fig.height = 6}

rast_heatf_plot

```

```{r, message = FALSE, fig.width = 8, fig.height = 6}

rast_heat_change_plot

```

### Waterlogging

\newpage

```{r climate_hazard_data_plot_3, echo=FALSE, message=FALSE, warning=FALSE}
rast_floodc_plot<- rast_floodc_plot_f(rast_floodc,
                   vect_ISO1,
                   vect_crop_ISO_lc_rcl_combined,
                   vect_ISO,
                   world,
                   ISO,
                   crop,
                   flood)

rast_floodf_plot<- rast_floodf_plot_f(rast_floodf,
                   vect_ISO1,
                   vect_crop_ISO_lc_rcl_combined,
                   vect_ISO,
                   world,
                   ISO,
                   crop,
                   flood)

rast_flood_change_plot <- rast_flood_change_plot_f(
  rast_flood_change,
  vect_ISO1,
  vect_crop_ISO_lc_rcl_combined,
  vect_ISO,
  world,
  ISO,
  crop,
  flood
)

```

```{r, message = FALSE, fig.width = 8, fig.height = 6}

rast_floodc_plot

```

```{r, message = FALSE, fig.width = 8, fig.height = 6}

rast_floodf_plot

```

```{r, message = FALSE, fig.width = 8, fig.height = 6}

rast_flood_change_plot


```

## Zonal Statistics

### Rainfall Calculations

```{r zonal_stats_rainfall, echo=FALSE, message=FALSE, warning=FALSE}

 
   
    dB_rainfallc_summary <- 
    dB_rainfallc_summary_make_f(rast_rainfallc, vect_crop_ISO_lc_rcl_combined)
   
   
    dB_rainfallf_summary <- 
    dB_rainfallf_summary_make_f(rast_rainfallf, vect_crop_ISO_lc_rcl_combined)
   
   
    dB_rainfall_change_summary <- 
    dB_rainfall_change_summary_make_f(rast_rainfall_change, vect_crop_ISO_lc_rcl_combined)


```

### Rainfall Plots

```{r zonal_stats_rainfall_plots, echo=FALSE, message=FALSE, warning=FALSE}
 

dB_rainfallc_summary_plot <-
  dB_rainfallc_summary_plot_f(dB_rainfallc_summary,
                              ISO,
                              crop)

dB_rainfallf_summary_plot <-
  dB_rainfallf_summary_plot_f(dB_rainfallf_summary,
                              ISO,
                              crop)


dB_rainfall_change_summary_plot <-
  dB_rainfall_change_summary_plot_f(dB_rainfall_change_summary,
                                    ISO,
                                    crop)


```

```{r, message = FALSE, fig.width = 8, fig.height = 6}

dB_rainfallc_summary_plot

```

```{r, message = FALSE, fig.width = 8, fig.height = 6}

dB_rainfallf_summary_plot

```

```{r, message = FALSE, fig.width = 8, fig.height = 6}

dB_rainfall_change_summary_plot

```

### Temperature Calculations

```{r zonal_stats_temp, echo=FALSE, message=FALSE, warning=FALSE}

 
   
    dB_tempc_summary <- 
    dB_tempc_summary_make_f(rast_tempc, vect_crop_ISO_lc_rcl_combined)
   
   
    dB_tempf_summary <- 
    dB_tempf_summary_make_f(rast_tempf, vect_crop_ISO_lc_rcl_combined)
   
   
    dB_temp_change_summary <- 
    dB_temp_change_summary_make_f(rast_temp_change, vect_crop_ISO_lc_rcl_combined)


```

### Temperature Plots

```{r zonal_stats_temp_plots, echo=FALSE, message=FALSE, warning=FALSE}
 
   
    dB_tempc_summary_plot <- 
    dB_tempc_summary_plot_f(
      dB_tempc_summary,
      ISO,
      crop
    )
   
   
    dB_tempf_summary_plot <- 
    dB_tempf_summary_plot_f(
      dB_tempf_summary,
      ISO,
      crop
    )
   
   
    dB_temp_change_summary_plot <- 
    dB_temp_change_summary_plot_f(
      dB_temp_change_summary,
      ISO,
      crop
    )


```

```{r, message = FALSE, fig.width = 8, fig.height = 6}

 dB_tempc_summary_plot

```

```{r, message = FALSE, fig.width = 8, fig.height = 6}

 dB_tempf_summary_plot

```

```{r, message = FALSE, fig.width = 8, fig.height = 6}

 dB_temp_change_summary_plot

```

### Season Onset Calculations

```{r zonal_stats_onset, echo=FALSE, message=FALSE, warning=FALSE}

 
   
    dB_onsetc_summary <- 
    dB_onsetc_summary_make_f(rast_onsetc, vect_crop_ISO_lc_rcl_combined)
   
   
    dB_onsetf_summary <- 
    dB_onsetf_summary_make_f(rast_onsetf, vect_crop_ISO_lc_rcl_combined)
   
   
    dB_onset_change_summary <- 
    dB_onset_change_summary_make_f(rast_onset_change, vect_crop_ISO_lc_rcl_combined)


```

### Season Onset Plots

```{r zonal_stats_onset_plots, echo=FALSE, message=FALSE, warning=FALSE}
 
   
    dB_onsetc_summary_plot <- 
    dB_onsetc_summary_plot_f(
      dB_onsetc_summary,
      ISO,
      crop
    )
   
   
    dB_onsetf_summary_plot <- 
    dB_onsetf_summary_plot_f(
      dB_onsetf_summary,
      ISO,
      crop
    )
   
   
    dB_onset_change_summary_plot <- 
    dB_onset_change_summary_plot_f(
      dB_onset_change_summary,
      ISO,
      crop
    )


```

```{r, message = FALSE, fig.width = 8, fig.height = 6}

 dB_onsetc_summary_plot 

```

```{r, message = FALSE, fig.width = 8, fig.height = 6}

 dB_onsetf_summary_plot

```

```{r, message = FALSE, fig.width = 8, fig.height = 6}

 dB_onset_change_summary_plot

```

### Season Duration Calculations

```{r zonal_stats_duration, echo=FALSE, message=FALSE, warning=FALSE}

 
   
    dB_durationc_summary <- 
    dB_durationc_summary_make_f(rast_durationc, vect_crop_ISO_lc_rcl_combined)
   
   
    dB_durationf_summary <- 
    dB_durationf_summary_make_f(rast_durationf, vect_crop_ISO_lc_rcl_combined)
   
   
    dB_duration_change_summary <- 
    dB_duration_change_summary_make_f(rast_duration_change, vect_crop_ISO_lc_rcl_combined)


```

### Season Duration Plots

```{r zonal_stats_duration_plots, echo=FALSE, message=FALSE, warning=FALSE}
 
   
    dB_durationc_summary_plot <- 
    dB_durationc_summary_plot_f(
      dB_durationc_summary,
      ISO,
      crop
    )
   
   
    dB_durationf_summary_plot <- 
    dB_durationf_summary_plot_f(
      dB_durationf_summary,
      ISO,
      crop
    )
   
   
    dB_duration_change_summary_plot <- 
    dB_duration_change_summary_plot_f(
      dB_duration_change_summary,
      ISO,
      crop
    )


```

```{r, message = FALSE, fig.width = 8, fig.height = 6}

 dB_durationc_summary_plot

```

```{r, message = FALSE, fig.width = 8, fig.height = 6}

 dB_durationf_summary_plot

```

```{r, message = FALSE, fig.width = 8, fig.height = 6}

 dB_duration_change_summary_plot

```

### Drought Calculations

```{r zonal_stats_drought, echo=FALSE, message=FALSE, warning=FALSE}

 
   
    dB_droughtc_summary <- 
    dB_droughtc_summary_make_f(rast_droughtc, vect_crop_ISO_lc_rcl_combined)
   
   
    dB_droughtf_summary <- 
    dB_droughtf_summary_make_f(rast_droughtf, vect_crop_ISO_lc_rcl_combined)
   
   
    dB_drought_change_summary <- 
    dB_drought_change_summary_make_f(rast_drought_change, vect_crop_ISO_lc_rcl_combined)


```

### Drought Plots

```{r zonal_stats_drought_plots, echo=FALSE, message=FALSE, warning=FALSE}
 
   
    dB_droughtc_summary_plot <- 
    dB_droughtc_summary_plot_f(
      dB_droughtc_summary,
      drought_threshold_l,
      drought_threshold_u,
      drought,
      ISO,
      crop
    )
   
   
    dB_droughtf_summary_plot <- 
    dB_droughtf_summary_plot_f(
      dB_droughtf_summary,
      drought_threshold_l,
      drought_threshold_u,
      drought,
      ISO,
      crop
    )
   
   
    dB_drought_change_summary_plot <- 
    dB_drought_change_summary_plot_f(
      dB_drought_change_summary,
      drought_threshold_l,
      drought_threshold_u,
      drought,
      ISO,
      crop
    )


```

```{r, message = FALSE, fig.width = 8, fig.height = 6}

 dB_droughtc_summary_plot

```

```{r, message = FALSE, fig.width = 8, fig.height = 6}

 dB_droughtf_summary_plot

```

```{r, message = FALSE, fig.width = 8, fig.height = 6}

 dB_drought_change_summary_plot

```

### Heat Stress Calculations

```{r zonal_stats_heat, echo=FALSE, message=FALSE, warning=FALSE}

 
   
    dB_heatc_summary <- 
    dB_heatc_summary_make_f(rast_heatc, vect_crop_ISO_lc_rcl_combined)
   
   
    dB_heatf_summary <- 
    dB_heatf_summary_make_f(rast_heatf, vect_crop_ISO_lc_rcl_combined)
   
   
    dB_heat_change_summary <- 
    dB_heat_change_summary_make_f(rast_heat_change, vect_crop_ISO_lc_rcl_combined)
  


```

### Heat Stress Plots

```{r zonal_stats_heat_plots, echo=FALSE, message=FALSE, warning=FALSE}
 
   
    dB_heatc_summary_plot <- 
    dB_heatc_summary_plot_f(
      dB_heatc_summary,
      heat_threshold_l,
      heat_threshold_u,
      heat,
      ISO,
      crop
    )
   
   
    dB_heatf_summary_plot <- 
    dB_heatf_summary_plot_f(
      dB_heatf_summary,
      heat_threshold_l,
      heat_threshold_u,
      heat,
      ISO,
      crop
    )
   
   
    dB_heat_change_summary_plot <- 
    dB_heat_change_summary_plot_f(
      dB_heat_change_summary,
      heat_threshold_l,
      heat_threshold_u,
      heat,
      ISO,
      crop
    )


```

```{r, message = FALSE, fig.width = 8, fig.height = 6}

 dB_heatc_summary_plot

```

```{r, message = FALSE, fig.width = 8, fig.height = 6}

 dB_heatf_summary_plot

```

```{r, message = FALSE, fig.width = 8, fig.height = 6}

 dB_heat_change_summary_plot

```

### Waterlogging Calculations

```{r zonal_stats_flood, echo=FALSE, message=FALSE, warning=FALSE}

 
   
    dB_floodc_summary <-
    dB_floodc_summary_make_f(rast_floodc, vect_crop_ISO_lc_rcl_combined)
   
   
    dB_floodf_summary <-
    dB_floodf_summary_make_f(rast_floodf, vect_crop_ISO_lc_rcl_combined)
   
   
    dB_flood_change_summary <-
    dB_flood_change_summary_make_f(rast_flood_change, vect_crop_ISO_lc_rcl_combined)
  


```

### Waterlogging Plots

```{r zonal_stats_flood_plots, echo=FALSE, message=FALSE, warning=FALSE}
 
   
    dB_floodc_summary_plot <-
    dB_floodc_summary_plot_f(
      dB_floodc_summary,
      flood_threshold_l,
      flood_threshold_u,
      flood,
      ISO,
      crop
    )
   
   
    dB_floodf_summary_plot <-
    dB_floodf_summary_plot_f(
      dB_floodf_summary,
      flood_threshold_l,
      flood_threshold_u,
      flood,
      ISO,
      crop
    )
   
   
    dB_flood_change_summary_plot <-
    dB_flood_change_summary_plot_f(
      dB_flood_change_summary,
      flood_threshold_l,
      flood_threshold_u,
      flood,
      ISO,
      crop
    )


```

```{r, message = FALSE, fig.width = 8, fig.height = 6}

 dB_floodc_summary_plot

```

```{r, message = FALSE, fig.width = 8, fig.height = 6}

 dB_floodf_summary_plot

```

```{r, message = FALSE, fig.width = 8, fig.height = 6}

 dB_flood_change_summary_plot

```

# Climate Hazard Impacts

## Prepare Impact Data

```{r  impact_data_prep, echo=FALSE, message=FALSE, warning=FALSE}

 
   dB_impact_prelim <- 
             dB_impact_prelim_make_f(rast_droughtc) 
   xy_impact <-
             xy_impact_make_f(dB_impact_prelim) 
  
   newcol_droughtc <-
    newcol_droughtc_make_f(xy_impact, rast_droughtc) 
   newcol_droughtf <-
    newcol_droughtf_make_f(xy_impact, rast_droughtf) 
  
   newcol_heatc <-
             newcol_heatc_make_f(xy_impact, rast_heatc) 
   newcol_heatf <-
             newcol_heatf_make_f(xy_impact, rast_heatf) 
  
   newcol_floodc <-
             newcol_floodc_make_f(xy_impact, rast_floodc) 
   newcol_floodf <-
             newcol_floodf_make_f(xy_impact, rast_floodf) 
  
   
    dB_impact <-
    dB_impact_make_f(
      dB_impact_prelim,
      newcol_droughtc,
      newcol_droughtf,
      newcol_heatc,
      newcol_heatf,
      newcol_floodc,
      newcol_floodf
    )


```

## Fuzzy Partition Construction

```{r  fuzzy_partitions_make, echo=FALSE, message=FALSE, warning=FALSE}
 
   
    fp_drought_l <-
    fp_drought_l_make_f(drought_threshold_l, drought_threshold_l_width)
   
   
    fp_drought_u <-
    fp_drought_u_make_f(drought_threshold_u, drought_threshold_u_width)
   
   
    fp_heat_l <-
    fp_heat_l_make_f(heat_threshold_l, heat_threshold_l_width)
   
   
    fp_heat_u <-
    fp_heat_u_make_f(heat_threshold_u, heat_threshold_u_width)
   
   
    fp_flood_l <-
    fp_flood_l_make_f(flood_threshold_l, flood_threshold_l_width)
   
   
    fp_flood_u <-
    fp_flood_u_make_f(flood_threshold_u, flood_threshold_u_width)


```

## Fuzzy Partition Plots

```{r  fuzzy_partitions_plot, echo=FALSE, message=FALSE, warning=FALSE}

fp_drought_l_plot <-
  fp_drought_l_plot_f(fp_drought_l, drought)

fp_drought_u_plot <-
  fp_drought_u_plot_f(fp_drought_u, drought)

fp_heat_l_plot <-
  fp_heat_l_plot_f(fp_heat_l, heat)

fp_heat_u_plot <-
  fp_heat_u_plot_f(fp_heat_u, heat)

fp_flood_l_plot <-
  fp_flood_l_plot_f(fp_flood_l, flood)

fp_flood_u_plot <-
  fp_flood_u_plot_f(fp_flood_u, flood)

```

```{r, message = FALSE, fig.width = 8, fig.height = 6}

 fp_drought_l_plot

```

```{r, message = FALSE, fig.width = 8, fig.height = 6}

 fp_drought_u_plot

```

```{r, message = FALSE, fig.width = 8, fig.height = 6}

 fp_heat_l_plot

```

```{r, message = FALSE, fig.width = 8, fig.height = 6}

 fp_heat_u_plot

```

```{r, message = FALSE, fig.width = 8, fig.height = 6}

 fp_flood_l_plot

```

```{r, message = FALSE, fig.width = 8, fig.height = 6}

 fp_flood_u_plot

```

## Single Hazard Rule Base Construction

```{r single_hazard_rule_base_make, echo=FALSE, message=FALSE, warning=FALSE}

 
   rb_droughtc <- rb_droughtc_make_f(drought) 
   rb_heatc <- rb_heatc_make_f(heat) 
   rb_floodc <- rb_floodc_make_f(flood) 
   rb_droughtf <- rb_droughtf_make_f(drought) 
   rb_heatf <- rb_heatf_make_f(heat) 
   rb_floodf <- rb_floodf_make_f(flood)

```

## Single Hazard Fuzzy Partition Matrix Prediction

### Lower Threshold

```{r single_hazard_fpm_l_predict, echo=FALSE, message=FALSE, warning=FALSE}

 
   
    fpm_droughtc_l <-
    fpm_droughtc_l_make_f(rb_droughtc, dB_impact, fp_drought_l)
   
   fpm_heatc_l <- fpm_heatc_l_make_f(rb_heatc, dB_impact, fp_heat_l) 
   fpm_floodc_l <- fpm_floodc_l_make_f(rb_floodc, dB_impact, fp_flood_l) 
   
    fpm_droughtf_l <-
    fpm_droughtf_l_make_f(rb_droughtf, dB_impact, fp_drought_l)
   
   fpm_heatf_l <- fpm_heatf_l_make_f(rb_heatf, dB_impact, fp_heat_l) 
   fpm_floodf_l <-  fpm_floodf_l_make_f(rb_floodf, dB_impact, fp_flood_l)

```

### Upper Threshold

```{r single_hazard_fpm_u_predict, echo=FALSE, message=FALSE, warning=FALSE}

 
   
    fpm_droughtc_u <-
    fpm_droughtc_u_make_f(rb_droughtc, dB_impact, fp_drought_u)
   
   fpm_heatc_u <- fpm_heatc_u_make_f(rb_heatc, dB_impact, fp_heat_u) 
   fpm_floodc_u <-  fpm_floodc_u_make_f(rb_floodc, dB_impact, fp_flood_u) 
   
    fpm_droughtf_u <-
    fpm_droughtf_u_make_f(rb_droughtf, dB_impact, fp_drought_u)
   
   fpm_heatf_u <- fpm_heatf_u_make_f(rb_heatf, dB_impact, fp_heat_u) 
   fpm_floodf_u <-  fpm_floodf_u_make_f(rb_floodf, dB_impact, fp_flood_u)

```

## Multiple Hazard Rule Base Construction

```{r multiple_hazard_rule_base_make, echo=FALSE, message=FALSE, warning=FALSE}

 
   rb_droughtc_heatc <- rb_droughtc_heatc_make_f(drought, heat) 
   
    rb_droughtc_floodc <-
    rb_droughtc_floodc_make_f(drought, flood)
   
   rb_heatc_floodc <- rb_heatc_floodc_make_f(heat, flood) 
   
    rb_droughtc_heatc_floodc <-
    rb_droughtc_heatc_floodc_make_f(drought, heat, flood)
   
   rb_droughtf_heatf <- rb_droughtf_heatf_make_f(drought, heat) 
   
    rb_droughtf_floodf <-
    rb_droughtf_floodf_make_f(drought, flood)
   
   rb_heatf_floodf <- rb_heatf_floodf_make_f(heat, flood) 
   
    rb_droughtf_heatf_floodf <-
    rb_droughtf_heatf_floodf_make_f(drought, heat, flood)


```

## Multiple Hazard Fuzzy Partition Matrix Prediction

### Lower Threshold

```{r multiple_hazard_fpm_l_predict, echo=FALSE, message=FALSE, warning=FALSE}

 
   
    fpm_droughtc_l_heatc_l <-
    fpm_droughtc_l_heatc_l_make_f(rb_droughtc_heatc, dB_impact, fp_drought_l, fp_heat_l)
   
   
    fpm_droughtc_l_floodc_l <-
    fpm_droughtc_l_floodc_l_make_f(rb_droughtc_floodc, dB_impact, fp_drought_l, fp_flood_l)
   
   
    fpm_heatc_l_floodc_l <-
    fpm_heatc_l_floodc_l_make_f(rb_heatc_floodc, dB_impact, fp_heat_l, fp_flood_l)
   
   
    fpm_droughtc_l_heatc_l_floodc_l <-
    fpm_droughtc_l_heatc_l_floodc_l_make_f(
      rb_droughtc_heatc_floodc,
      dB_impact,
      fp_drought_l,
      fp_heat_l,
      fp_flood_l
    )
   
   
    fpm_droughtf_l_heatf_l <-
    fpm_droughtf_l_heatf_l_make_f(rb_droughtf_heatf, dB_impact, fp_drought_l, fp_heat_l)
   
   
    fpm_droughtf_l_floodf_l <-
    fpm_droughtf_l_floodf_l_make_f(rb_droughtf_floodf, dB_impact, fp_drought_l, fp_flood_l)
   
   
    fpm_heatf_l_floodf_l <-
    fpm_heatf_l_floodf_l_make_f(rb_heatf_floodf, dB_impact, fp_heat_l, fp_flood_l)
   
   
    fpm_droughtf_l_heatf_l_floodf_l <-
    fpm_droughtf_l_heatf_l_floodf_l_make_f(
      rb_droughtf_heatf_floodf,
      dB_impact,
      fp_drought_l,
      fp_heat_l,
      fp_flood_l
    )


```

### Upper Threshold

```{r multiple_hazard_fpm_u_predict, echo=FALSE, message=FALSE, warning=FALSE}

 
   
    fpm_droughtc_u_heatc_u <-
    fpm_droughtc_u_heatc_u_make_f(rb_droughtc_heatc, dB_impact, fp_drought_u, fp_heat_u)
   
   
    fpm_droughtc_u_floodc_u <-
    fpm_droughtc_u_floodc_u_make_f(rb_droughtc_floodc, dB_impact, fp_drought_u, fp_flood_u)
   
   
    fpm_heatc_u_floodc_u <-
    fpm_heatc_u_floodc_u_make_f(rb_heatc_floodc, dB_impact, fp_heat_u, fp_flood_u)
   
   
    fpm_droughtc_u_heatc_u_floodc_u <-
    fpm_droughtc_u_heatc_u_floodc_u_make_f(
      rb_droughtc_heatc_floodc,
      dB_impact,
      fp_drought_u,
      fp_heat_u,
      fp_flood_u
    )
   
   
    fpm_droughtf_u_heatf_u <-
    fpm_droughtf_u_heatf_u_make_f(rb_droughtf_heatf, dB_impact, fp_drought_u, fp_heat_u)
   
   
    fpm_droughtf_u_floodf_u <-
    fpm_droughtf_u_floodf_u_make_f(rb_droughtf_floodf, dB_impact, fp_drought_u, fp_flood_u)
   
   
    fpm_heatf_u_floodf_u <-
    fpm_heatf_u_floodf_u_make_f(rb_heatf_floodf, dB_impact, fp_heat_u, fp_flood_u)
   
   
    fpm_droughtf_u_heatf_u_floodf_u <-
    fpm_droughtf_u_heatf_u_floodf_u_make_f(
      rb_droughtf_heatf_floodf,
      dB_impact,
      fp_drought_u,
      fp_heat_u,
      fp_flood_u
    )


```

### Mixed Thresholds

```{r multiple_hazard_fpm_mixed_predict_c, echo=FALSE, message=FALSE, warning=FALSE}

 
   
    fpm_droughtc_l_heatc_u  <-
    fpm_droughtc_l_heatc_u_make_f(rb_droughtc_heatc, dB_impact, fp_drought_l, fp_heat_u)
   
   
    fpm_droughtc_u_heatc_l   <-
    fpm_droughtc_u_heatc_l_make_f(rb_droughtc_heatc, dB_impact, fp_drought_u, fp_heat_l)
   
  
   
    fpm_droughtc_l_floodc_u   <-
    fpm_droughtc_l_floodc_u_make_f(rb_droughtc_floodc, dB_impact, fp_drought_l, fp_flood_u)
   
   
    fpm_droughtc_u_floodc_l   <-
    fpm_droughtc_u_floodc_l_make_f(rb_droughtc_floodc, dB_impact, fp_drought_u, fp_flood_l)
   
  
   
    fpm_heatc_l_floodc_u   <-
    fpm_heatc_l_floodc_u_make_f(rb_heatc_floodc, dB_impact, fp_heat_l, fp_flood_u)
   
   
    fpm_heatc_u_floodc_l <-
    fpm_heatc_u_floodc_l_make_f(rb_heatc_floodc, dB_impact, fp_heat_u, fp_flood_l)
   
  
   
    fpm_droughtc_l_heatc_l_floodc_u  <-
    fpm_droughtc_l_heatc_l_floodc_u_make_f(
      rb_droughtc_heatc_floodc,
      dB_impact,
      fp_drought_l,
      fp_heat_l,
      fp_flood_u
    )
   
   
    fpm_droughtc_l_heatc_u_floodc_l   <-
    fpm_droughtc_l_heatc_u_floodc_l_make_f(
      rb_droughtc_heatc_floodc,
      dB_impact,
      fp_drought_l,
      fp_heat_u,
      fp_flood_l
    )
   
   
    fpm_droughtc_u_heatc_l_floodc_u  <- 
    fpm_droughtc_u_heatc_l_floodc_u_make_f(
      rb_droughtc_heatc_floodc,
      dB_impact,
      fp_drought_u,
      fp_heat_l,
      fp_flood_u
    )
   
   
    fpm_droughtc_u_heatc_l_floodc_l   <-
    fpm_droughtc_u_heatc_l_floodc_l_make_f(
      rb_droughtc_heatc_floodc,
      dB_impact,
      fp_drought_u,
      fp_heat_l,
      fp_flood_l
    )
   
   
    fpm_droughtc_u_heatc_u_floodc_l  <-
    fpm_droughtc_u_heatc_u_floodc_l_make_f(
      rb_droughtc_heatc_floodc,
      dB_impact,
      fp_drought_u,
      fp_heat_u,
      fp_flood_l
    )
   
   
    fpm_droughtc_l_heatc_u_floodc_u  <-
    fpm_droughtc_l_heatc_u_floodc_u_make_f(
      rb_droughtc_heatc_floodc,
      dB_impact,
      fp_drought_l,
      fp_heat_u,
      fp_flood_u
    )


```

```{r multiple_hazard_fpm_mixed_predict_f, echo=FALSE, message=FALSE, warning=FALSE}

 
   
    fpm_droughtf_l_heatf_u  <-
    fpm_droughtf_l_heatf_u_make_f(rb_droughtf_heatf, dB_impact, fp_drought_l, fp_heat_u)
   
   
    fpm_droughtf_u_heatf_l  <-
    fpm_droughtf_u_heatf_l_make_f(rb_droughtf_heatf, dB_impact, fp_drought_u, fp_heat_l)
   
  
   
    fpm_droughtf_l_floodf_u  <-
    fpm_droughtf_l_floodf_u_make_f(rb_droughtf_floodf, dB_impact, fp_drought_l, fp_flood_u)
   
   
    fpm_droughtf_u_floodf_l  <-
    fpm_droughtf_u_floodf_l_make_f(rb_droughtf_floodf, dB_impact, fp_drought_u, fp_flood_l)
   
  
   
    fpm_heatf_l_floodf_u   <-
    fpm_heatf_l_floodf_u_make_f(rb_heatf_floodf, dB_impact, fp_heat_l, fp_flood_u)
   
   
    fpm_heatf_u_floodf_l   <-
    fpm_heatf_u_floodf_l_make_f(rb_heatf_floodf, dB_impact, fp_heat_u, fp_flood_l)
   
  
   
    fpm_droughtf_l_heatf_l_floodf_u  <-
    fpm_droughtf_l_heatf_l_floodf_u_make_f(
      rb_droughtf_heatf_floodf,
      dB_impact,
      fp_drought_l,
      fp_heat_l,
      fp_flood_u
    )
   
   
    fpm_droughtf_l_heatf_u_floodf_l  <-
    fpm_droughtf_l_heatf_u_floodf_l_make_f(
      rb_droughtf_heatf_floodf,
      dB_impact,
      fp_drought_l,
      fp_heat_u,
      fp_flood_l
    )
   
   
    fpm_droughtf_u_heatf_l_floodf_u  <-
    fpm_droughtf_u_heatf_l_floodf_u_make_f(
      rb_droughtf_heatf_floodf,
      dB_impact,
      fp_drought_u,
      fp_heat_l,
      fp_flood_u
    )
   
   
    fpm_droughtf_u_heatf_l_floodf_l  <-
    fpm_droughtf_u_heatf_l_floodf_l_make_f(
      rb_droughtf_heatf_floodf,
      dB_impact,
      fp_drought_u,
      fp_heat_l,
      fp_flood_l
    )
   
   
    fpm_droughtf_u_heatf_u_floodf_l   <-
    fpm_droughtf_u_heatf_u_floodf_l_make_f(
      rb_droughtf_heatf_floodf,
      dB_impact,
      fp_drought_u,
      fp_heat_u,
      fp_flood_l
    )
   
   
    fpm_droughtf_l_heatf_u_floodf_u  <-
    fpm_droughtf_l_heatf_u_floodf_u_make_f(
      rb_droughtf_heatf_floodf,
      dB_impact,
      fp_drought_l,
      fp_heat_u,
      fp_flood_u
    )


```

## Finalise Impact Data

```{r impact_data_finalisation}


  dB_impact_full <-  dB_impact_full_make_f(dB_impact,
      fpm_droughtc_l,
      fpm_heatc_l,
      fpm_floodc_l,
      fpm_droughtf_l,
      fpm_heatf_l,
      fpm_floodf_l,
      fpm_droughtc_l_heatc_l,
      fpm_droughtc_l_floodc_l,
      fpm_heatc_l_floodc_l,
      fpm_droughtc_l_heatc_l_floodc_l,
      fpm_droughtf_l_heatf_l,
      fpm_droughtf_l_floodf_l,
      fpm_heatf_l_floodf_l,
      fpm_droughtf_l_heatf_l_floodf_l,
      fpm_droughtc_u,
      fpm_heatc_u,
      fpm_floodc_u,
      fpm_droughtf_u,
      fpm_heatf_u,
      fpm_floodf_u,
      fpm_droughtc_u_heatc_u,
      fpm_droughtc_u_floodc_u,
      fpm_heatc_u_floodc_u,
      fpm_droughtc_u_heatc_u_floodc_u,
      fpm_droughtf_u_heatf_u,
      fpm_droughtf_u_floodf_u,
      fpm_heatf_u_floodf_u,
      fpm_droughtf_u_heatf_u_floodf_u,
      fpm_droughtc_l_heatc_u,
      fpm_droughtc_u_heatc_l,
      fpm_droughtc_l_floodc_u,
      fpm_droughtc_u_floodc_l,
      fpm_heatc_l_floodc_u,
      fpm_heatc_u_floodc_l,
      fpm_droughtc_l_heatc_l_floodc_u,
      fpm_droughtc_l_heatc_u_floodc_l,
      fpm_droughtc_u_heatc_l_floodc_u,
      fpm_droughtc_u_heatc_l_floodc_l,
      fpm_droughtc_u_heatc_u_floodc_l,
      fpm_droughtc_l_heatc_u_floodc_u,
      fpm_droughtf_l_heatf_u,
      fpm_droughtf_u_heatf_l,
      fpm_droughtf_l_floodf_u,
      fpm_droughtf_u_floodf_l,
      fpm_heatf_l_floodf_u,
      fpm_heatf_u_floodf_l,
      fpm_droughtf_l_heatf_l_floodf_u,
      fpm_droughtf_l_heatf_u_floodf_l,
      fpm_droughtf_u_heatf_l_floodf_u,
      fpm_droughtf_u_heatf_l_floodf_l,
      fpm_droughtf_u_heatf_u_floodf_l,
      fpm_droughtf_l_heatf_u_floodf_u)
```

## Spatialise Impact Data

```{r impact_data_spatialisation_1}


  vect_impact <- vect_impact_make_f(dB_impact_full)
  
    rast_impact_prelim <-
    rast_impact_prelim_make_f(vect_impact, rast_droughtc)
  
  
    rast_impact <-
    rast_impact_make_f(vect_impact, rast_droughtc, rast_impact_prelim)


```

```{r impact_data_spatialisation_2}

rast_impact_file <-
                rast_impact_file_make_f(rast_impact, ISO, crop)

```

## Reload Spatial Impact Data

```{r impact_cat_table_1}


    impact_cat_table <- impact_cat_table_make_f()

```

### Past Lower threshold

```{r impact_data_reload_1}


    
    rast_droughtc_l_heatc_l_max <-
    rast_droughtc_l_heatc_l_max_get_f(rast_impact_file, ISO, crop, impact_cat_table)
  
    
    rast_droughtc_l_floodc_l_max <-
    rast_droughtc_l_floodc_l_max_get_f(rast_impact_file, ISO, crop, impact_cat_table)
  
  
    rast_heatc_l_floodc_l_max <-
    rast_heatc_l_floodc_l_max_get_f(rast_impact_file, ISO, crop, impact_cat_table)
  
  
    rast_droughtc_l_heatc_l_floodc_l_max <-
    rast_droughtc_l_heatc_l_floodc_l_max_get_f(rast_impact_file, ISO, crop, impact_cat_table)


```

### Past Upper threshold

```{r impact_data_reload_2}


    
    rast_droughtc_u_heatc_u_max <-
    rast_droughtc_u_heatc_u_max_get_f(rast_impact_file, ISO, crop, impact_cat_table)
  
    
    rast_droughtc_u_floodc_u_max <-
    rast_droughtc_u_floodc_u_max_get_f(rast_impact_file, ISO, crop, impact_cat_table)
  
  
    rast_heatc_u_floodc_u_max <-
    rast_heatc_u_floodc_u_max_get_f(rast_impact_file, ISO, crop, impact_cat_table)
  
  
    rast_droughtc_u_heatc_u_floodc_u_max <-
    rast_droughtc_u_heatc_u_floodc_u_max_get_f(rast_impact_file, ISO, crop, impact_cat_table)


```

### Past Mixed threshold

```{r impact_data_reload_3}


  
    rast_droughtc_l_heatc_u_max <-
    rast_droughtc_l_heatc_u_max_get_f(rast_impact_file, ISO, crop, impact_cat_table)
  
  
    rast_droughtc_u_heatc_l_max <-
    rast_droughtc_u_heatc_l_max_get_f(rast_impact_file, ISO, crop, impact_cat_table)
  
  
    rast_droughtc_l_floodc_u_max <-
    rast_droughtc_l_floodc_u_max_get_f(rast_impact_file, ISO, crop, impact_cat_table)
  
  
    rast_droughtc_u_floodc_l_max <-
    rast_droughtc_u_floodc_l_max_get_f(rast_impact_file, ISO, crop, impact_cat_table)
  
  
    rast_heatc_l_floodc_u_max <-
    rast_heatc_l_floodc_u_max_get_f(rast_impact_file, ISO, crop, impact_cat_table)
  
  
    rast_heatc_u_floodc_l_max <-
    rast_heatc_u_floodc_l_max_get_f(rast_impact_file, ISO, crop, impact_cat_table)
  
  
    rast_droughtc_l_heatc_l_floodc_u_max <-
    rast_droughtc_l_heatc_l_floodc_u_max_get_f(rast_impact_file, ISO, crop, impact_cat_table)
  
  
    rast_droughtc_l_heatc_u_floodc_l_max <-
    rast_droughtc_l_heatc_u_floodc_l_max_get_f(rast_impact_file, ISO, crop, impact_cat_table)
  
  
    rast_droughtc_u_heatc_l_floodc_l_max <-
    rast_droughtc_u_heatc_l_floodc_l_max_get_f(rast_impact_file, ISO, crop, impact_cat_table)
  
  
    rast_droughtc_l_heatc_u_floodc_u_max <-
    rast_droughtc_l_heatc_u_floodc_u_max_get_f(rast_impact_file, ISO, crop, impact_cat_table)
  
  
    rast_droughtc_u_heatc_l_floodc_u_max <-
    rast_droughtc_u_heatc_l_floodc_u_max_get_f(rast_impact_file, ISO, crop, impact_cat_table)
  
  
    rast_droughtc_u_heatc_u_floodc_l_max <-
    rast_droughtc_u_heatc_u_floodc_l_max_get_f(rast_impact_file, ISO, crop, impact_cat_table)

```

### Future Lower threshold

```{r impact_data_reload_4}


    
    rast_droughtf_l_heatf_l_max <-
    rast_droughtf_l_heatf_l_max_get_f(rast_impact_file, ISO, crop, impact_cat_table)
  
    
    rast_droughtf_l_floodf_l_max <-
    rast_droughtf_l_floodf_l_max_get_f(rast_impact_file, ISO, crop, impact_cat_table)
  
  
    rast_heatf_l_floodf_l_max <-
    rast_heatf_l_floodf_l_max_get_f(rast_impact_file, ISO, crop, impact_cat_table)
  
  
    rast_droughtf_l_heatf_l_floodf_l_max <-
    rast_droughtf_l_heatf_l_floodf_l_max_get_f(rast_impact_file, ISO, crop, impact_cat_table)

```

### Future Upper threshold

```{r impact_data_reload_5}


    
    rast_droughtf_u_heatf_u_max <-
    rast_droughtf_u_heatf_u_max_get_f(rast_impact_file, ISO, crop, impact_cat_table)
  
    
    rast_droughtf_u_floodf_u_max <-
    rast_droughtf_u_floodf_u_max_get_f(rast_impact_file, ISO, crop, impact_cat_table)
  
  
    rast_heatf_u_floodf_u_max <-
    rast_heatf_u_floodf_u_max_get_f(rast_impact_file, ISO, crop, impact_cat_table)
  
  
    rast_droughtf_u_heatf_u_floodf_u_max <-
    rast_droughtf_u_heatf_u_floodf_u_max_get_f(rast_impact_file, ISO, crop, impact_cat_table)


```

### Future Mixed threshold

```{r impact_data_reload_6}


  
    rast_droughtf_l_heatf_u_max <-
    rast_droughtf_l_heatf_u_max_get_f(rast_impact_file, ISO, crop, impact_cat_table)
  
  
    rast_droughtf_u_heatf_l_max <-
    rast_droughtf_u_heatf_l_max_get_f(rast_impact_file, ISO, crop, impact_cat_table)
  
  
    rast_droughtf_l_floodf_u_max <-
    rast_droughtf_l_floodf_u_max_get_f(rast_impact_file, ISO, crop, impact_cat_table)
  
  
    rast_droughtf_u_floodf_l_max <-
    rast_droughtf_u_floodf_l_max_get_f(rast_impact_file, ISO, crop, impact_cat_table)
  
  
    rast_heatf_l_floodf_u_max <-
    rast_heatf_l_floodf_u_max_get_f(rast_impact_file, ISO, crop, impact_cat_table)
  
  
    rast_heatf_u_floodf_l_max <-
    rast_heatf_u_floodf_l_max_get_f(rast_impact_file, ISO, crop, impact_cat_table)
  
  
    rast_droughtf_l_heatf_l_floodf_u_max <-
    rast_droughtf_l_heatf_l_floodf_u_max_get_f(rast_impact_file, ISO, crop, impact_cat_table)
  
  
    rast_droughtf_l_heatf_u_floodf_l_max <-
    rast_droughtf_l_heatf_u_floodf_l_max_get_f(rast_impact_file, ISO, crop, impact_cat_table)
  
  
    rast_droughtf_u_heatf_l_floodf_l_max <-
    rast_droughtf_u_heatf_l_floodf_l_max_get_f(rast_impact_file, ISO, crop, impact_cat_table)
  
  
    rast_droughtf_l_heatf_u_floodf_u_max <-
    rast_droughtf_l_heatf_u_floodf_u_max_get_f(rast_impact_file, ISO, crop, impact_cat_table)
  
  
    rast_droughtf_u_heatf_l_floodf_u_max <-
    rast_droughtf_u_heatf_l_floodf_u_max_get_f(rast_impact_file, ISO, crop, impact_cat_table)
  
  
    rast_droughtf_u_heatf_u_floodf_l_max <-
    rast_droughtf_u_heatf_u_floodf_l_max_get_f(rast_impact_file, ISO, crop, impact_cat_table)

```

## Plot Spatial Impact Data

### Past Lower threshold

```{r impact_data_plot_1}


  
    rast_droughtc_l_heatc_l_max_plot <- 
    rast_droughtc_l_heatc_l_max_plot_f(
      rast_droughtc_l_heatc_l_max,
      vect_ISO1,
      vect_crop_ISO_lc_rcl_combined,
      vect_ISO,
      world,
      ISO,
      crop,
      flood
    )
  
  
    rast_droughtc_l_floodc_l_max_plot <-
    rast_droughtc_l_floodc_l_max_plot_f(
      rast_droughtc_l_floodc_l_max,
      vect_ISO1,
      vect_crop_ISO_lc_rcl_combined,
      vect_ISO,
      world,
      ISO,
      crop,
      flood
    )
  
  
    rast_heatc_l_floodc_l_max_plot <-
    rast_heatc_l_floodc_l_max_plot_f(
      rast_heatc_l_floodc_l_max,
      vect_ISO1,
      vect_crop_ISO_lc_rcl_combined,
      vect_ISO,
      world,
      ISO,
      crop,
      flood
    )
  
  
    rast_droughtc_l_heatc_l_floodc_l_max_plot <-
    rast_droughtc_l_heatc_l_floodc_l_max_plot_f(
      rast_droughtc_l_heatc_l_floodc_l_max,
      vect_ISO1,
      vect_crop_ISO_lc_rcl_combined,
      vect_ISO,
      world,
      ISO,
      crop,
      flood
    )


```

### Past Upper threshold

```{r impact_data_plot_2}


  
    rast_droughtc_u_heatc_u_max_plot <-
    rast_droughtc_u_heatc_u_max_plot_f(
      rast_droughtc_u_heatc_u_max,
      vect_ISO1,
      vect_crop_ISO_lc_rcl_combined,
      vect_ISO,
      world,
      ISO,
      crop,
      flood
    )
  
  
    rast_droughtc_u_floodc_u_max_plot <-
    rast_droughtc_u_floodc_u_max_plot_f(
      rast_droughtc_u_floodc_u_max,
      vect_ISO1,
      vect_crop_ISO_lc_rcl_combined,
      vect_ISO,
      world,
      ISO,
      crop,
      flood
    )
  
  
    rast_heatc_u_floodc_u_max_plot <-
    rast_heatc_u_floodc_u_max_plot_f(
       rast_heatc_u_floodc_u_max,
      vect_ISO1,
      vect_crop_ISO_lc_rcl_combined,
      vect_ISO,
      world,
      ISO,
      crop,
      flood
    )
  
  
    rast_droughtc_u_heatc_u_floodc_u_max_plot <-
    rast_droughtc_u_heatc_u_floodc_u_max_plot_f(
      rast_droughtc_u_heatc_u_floodc_u_max,
      vect_ISO1,
      vect_crop_ISO_lc_rcl_combined,
      vect_ISO,
      world,
      ISO,
      crop,
      flood
    )


```

### Past Mixed threshold

```{r impact_data_plot_3}


  
    rast_droughtc_l_heatc_u_max_plot <-
    rast_droughtc_l_heatc_u_max_plot_f(
      rast_droughtc_l_heatc_u_max,
      vect_ISO1,
      vect_crop_ISO_lc_rcl_combined,
      vect_ISO,
      world,
      ISO,
      crop,
      flood
    )
  
  
    rast_droughtc_u_heatc_l_max_plot <-
    rast_droughtc_u_heatc_l_max_plot_f(
       rast_droughtc_u_heatc_l_max,
      vect_ISO1,
      vect_crop_ISO_lc_rcl_combined,
      vect_ISO,
      world,
      ISO,
      crop,
      flood
    )
  
  
    rast_droughtc_l_floodc_u_max_plot <-
    rast_droughtc_l_floodc_u_max_plot_f(
      rast_droughtc_l_floodc_u_max,
      vect_ISO1,
      vect_crop_ISO_lc_rcl_combined,
      vect_ISO,
      world,
      ISO,
      crop,
      flood
    )
  
  
    rast_droughtc_u_floodc_l_max_plot <-
    rast_droughtc_u_floodc_l_max_plot_f(
      rast_droughtc_u_floodc_l_max,
      vect_ISO1,
      vect_crop_ISO_lc_rcl_combined,
      vect_ISO,
      world,
      ISO,
      crop,
      flood
    )
  
  
    rast_heatc_l_floodc_u_max_plot <-
    rast_heatc_l_floodc_u_max_plot_f(
      rast_heatc_l_floodc_u_max,
      vect_ISO1,
      vect_crop_ISO_lc_rcl_combined,
      vect_ISO,
      world,
      ISO,
      crop,
      flood
    )
  
  
    rast_heatc_u_floodc_l_max_plot <-
    rast_heatc_u_floodc_l_max_plot_f(
      rast_heatc_u_floodc_l_max,
      vect_ISO1,
      vect_crop_ISO_lc_rcl_combined,
      vect_ISO,
      world,
      ISO,
      crop,
      flood
    )
  
  
    rast_droughtc_l_heatc_l_floodc_u_max_plot <-
    rast_droughtc_l_heatc_l_floodc_u_max_plot_f(
      rast_droughtc_l_heatc_l_floodc_u_max,
      vect_ISO1,
      vect_crop_ISO_lc_rcl_combined,
      vect_ISO,
      world,
      ISO,
      crop,
      flood
    )
  
  
    rast_droughtc_l_heatc_u_floodc_l_max_plot <-
    rast_droughtc_l_heatc_u_floodc_l_max_plot_f(
      rast_droughtc_l_heatc_u_floodc_l_max,
      vect_ISO1,
      vect_crop_ISO_lc_rcl_combined,
      vect_ISO,
      world,
      ISO,
      crop,
      flood
    )
  
  
    rast_droughtc_u_heatc_l_floodc_l_max_plot <-
    rast_droughtc_u_heatc_l_floodc_l_max_plot_f(
      rast_droughtc_u_heatc_l_floodc_l_max,
      vect_ISO1,
      vect_crop_ISO_lc_rcl_combined,
      vect_ISO,
      world,
      ISO,
      crop,
      flood
    )
  
  
    rast_droughtc_l_heatc_u_floodc_u_max_plot <-
    rast_droughtc_l_heatc_u_floodc_u_max_plot_f(
      rast_droughtc_l_heatc_u_floodc_u_max,
      vect_ISO1,
      vect_crop_ISO_lc_rcl_combined,
      vect_ISO,
      world,
      ISO,
      crop,
      flood
    )
  
  
    rast_droughtc_u_heatc_l_floodc_u_max_plot <-
    rast_droughtc_u_heatc_l_floodc_u_max_plot_f(
      rast_droughtc_u_heatc_l_floodc_u_max,
      vect_ISO1,
      vect_crop_ISO_lc_rcl_combined,
      vect_ISO,
      world,
      ISO,
      crop,
      flood
    )
  
  
    rast_droughtc_u_heatc_u_floodc_l_max_plot <-
    rast_droughtc_u_heatc_u_floodc_l_max_plot_f(
      rast_droughtc_u_heatc_u_floodc_l_max,
      vect_ISO1,
      vect_crop_ISO_lc_rcl_combined,
      vect_ISO,
      world,
      ISO,
      crop,
      flood
    )

```

### Future Lower threshold

```{r impact_data_plot_4}


  
    rast_droughtf_l_heatf_l_max_plot <-
    rast_droughtf_l_heatf_l_max_plot_f(
      rast_droughtf_l_heatf_l_max,
      vect_ISO1,
      vect_crop_ISO_lc_rcl_combined,
      vect_ISO,
      world,
      ISO,
      crop,
      flood
    )
  
  
    rast_droughtf_l_floodf_l_max_plot <-
    rast_droughtf_l_floodf_l_max_plot_f(
      rast_droughtf_l_floodf_l_max,
      vect_ISO1,
      vect_crop_ISO_lc_rcl_combined,
      vect_ISO,
      world,
      ISO,
      crop,
      flood
    )
  
  
    rast_heatf_l_floodf_l_max_plot <-
    rast_heatf_l_floodf_l_max_plot_f(
      rast_heatf_l_floodf_l_max,
      vect_ISO1,
      vect_crop_ISO_lc_rcl_combined,
      vect_ISO,
      world,
      ISO,
      crop,
      flood
    )
  
  
    rast_droughtf_l_heatf_l_floodf_l_max_plot <-
    rast_droughtf_l_heatf_l_floodf_l_max_plot_f(
      rast_droughtf_l_heatf_l_floodf_l_max,
      vect_ISO1,
      vect_crop_ISO_lc_rcl_combined,
      vect_ISO,
      world,
      ISO,
      crop,
      flood
    )


```

### Future Upper threshold

```{r impact_data_plot_5}


  
    rast_droughtf_u_heatf_u_max_plot <-
    rast_droughtf_u_heatf_u_max_plot_f(
      rast_droughtf_u_heatf_u_max,
      vect_ISO1,
      vect_crop_ISO_lc_rcl_combined,
      vect_ISO,
      world,
      ISO,
      crop,
      flood
    )
  
  
    rast_droughtf_u_floodf_u_max_plot <-
    rast_droughtf_u_floodf_u_max_plot_f(
      rast_droughtf_u_floodf_u_max,
      vect_ISO1,
      vect_crop_ISO_lc_rcl_combined,
      vect_ISO,
      world,
      ISO,
      crop,
      flood
    )
  
  
    rast_heatf_u_floodf_u_max_plot <-
    rast_heatf_u_floodf_u_max_plot_f(
      rast_heatf_u_floodf_u_max,
      vect_ISO1,
      vect_crop_ISO_lc_rcl_combined,
      vect_ISO,
      world,
      ISO,
      crop,
      flood
    )
  
  
    rast_droughtf_u_heatf_u_floodf_u_max_plot <-
    rast_droughtf_u_heatf_u_floodf_u_max_plot_f(
      rast_droughtf_u_heatf_u_floodf_u_max,
      vect_ISO1,
      vect_crop_ISO_lc_rcl_combined,
      vect_ISO,
      world,
      ISO,
      crop,
      flood
    )


```

### Future Mixed threshold

```{r impact_data_plot_6}


  
    rast_droughtf_l_heatf_u_max_plot <-
    rast_droughtf_l_heatf_u_max_plot_f(
      rast_droughtf_l_heatf_u_max,
      vect_ISO1,
      vect_crop_ISO_lc_rcl_combined,
      vect_ISO,
      world,
      ISO,
      crop,
      flood
    )
  
  
    rast_droughtf_u_heatf_l_max_plot <-
    rast_droughtf_u_heatf_l_max_plot_f(
      rast_droughtf_u_heatf_l_max,
      vect_ISO1,
      vect_crop_ISO_lc_rcl_combined,
      vect_ISO,
      world,
      ISO,
      crop,
      flood
    )
  
  
    rast_droughtf_l_floodf_u_max_plot <-
    rast_droughtf_l_floodf_u_max_plot_f(
      rast_droughtf_l_floodf_u_max,
      vect_ISO1,
      vect_crop_ISO_lc_rcl_combined,
      vect_ISO,
      world,
      ISO,
      crop,
      flood
    )
  
  
    rast_droughtf_u_floodf_l_max_plot <-
    rast_droughtf_u_floodf_l_max_plot_f(
      rast_droughtf_u_floodf_l_max,
      vect_ISO1,
      vect_crop_ISO_lc_rcl_combined,
      vect_ISO,
      world,
      ISO,
      crop,
      flood
    )
  
  
    rast_heatf_l_floodf_u_max_plot <-
    rast_heatf_l_floodf_u_max_plot_f(
      rast_heatf_l_floodf_u_max,
      vect_ISO1,
      vect_crop_ISO_lc_rcl_combined,
      vect_ISO,
      world,
      ISO,
      crop,
      flood
    )
  
  
    rast_heatf_u_floodf_l_max_plot <-
    rast_heatf_u_floodf_l_max_plot_f(
      rast_heatf_u_floodf_l_max,
      vect_ISO1,
      vect_crop_ISO_lc_rcl_combined,
      vect_ISO,
      world,
      ISO,
      crop,
      flood
    )
  
  
    rast_droughtf_l_heatf_l_floodf_u_max_plot <-
    rast_droughtf_l_heatf_l_floodf_u_max_plot_f(
      rast_droughtf_l_heatf_l_floodf_u_max,
      vect_ISO1,
      vect_crop_ISO_lc_rcl_combined,
      vect_ISO,
      world,
      ISO,
      crop,
      flood
    )
  
  
    rast_droughtf_l_heatf_u_floodf_l_max_plot <-
    rast_droughtf_l_heatf_u_floodf_l_max_plot_f(
      rast_droughtf_l_heatf_u_floodf_l_max,
      vect_ISO1,
      vect_crop_ISO_lc_rcl_combined,
      vect_ISO,
      world,
      ISO,
      crop,
      flood
    )
  
  
    rast_droughtf_u_heatf_l_floodf_l_max_plot <-
    rast_droughtf_u_heatf_l_floodf_l_max_plot_f(
      rast_droughtf_u_heatf_l_floodf_l_max,
      vect_ISO1,
      vect_crop_ISO_lc_rcl_combined,
      vect_ISO,
      world,
      ISO,
      crop,
      flood
    )
  
  
    rast_droughtf_l_heatf_u_floodf_u_max_plot <-
    rast_droughtf_l_heatf_u_floodf_u_max_plot_f(
      rast_droughtf_l_heatf_u_floodf_u_max,
      vect_ISO1,
      vect_crop_ISO_lc_rcl_combined,
      vect_ISO,
      world,
      ISO,
      crop,
      flood
    )
  
  
    rast_droughtf_u_heatf_l_floodf_u_max_plot <-
    rast_droughtf_u_heatf_l_floodf_u_max_plot_f(
      rast_droughtf_u_heatf_l_floodf_u_max,
      vect_ISO1,
      vect_crop_ISO_lc_rcl_combined,
      vect_ISO,
      world,
      ISO,
      crop,
      flood
    )
  
  
    rast_droughtf_u_heatf_u_floodf_l_max_plot <-
    rast_droughtf_u_heatf_u_floodf_l_max_plot_f(
      rast_droughtf_u_heatf_u_floodf_l_max,
      vect_ISO1,
      vect_crop_ISO_lc_rcl_combined,
      vect_ISO,
      world,
      ISO,
      crop,
      flood
    )

```

# Impact Zonal Statistics

## Drought Calculation

```{r impact_zonal_drought}


  
    dB_droughtc_l_summary <-
    dB_droughtc_l_summary_make_f(rast_impact, vect_crop_ISO_lc_rcl_combined)
  
  
    dB_droughtf_l_summary <-
    dB_droughtf_l_summary_make_f(rast_impact, vect_crop_ISO_lc_rcl_combined)
  
  
    dB_drought_change_l_summary <-
    dB_drought_change_l_summary_make_f(rast_impact, vect_crop_ISO_lc_rcl_combined)
  
    
    dB_droughtc_u_summary <-
    dB_droughtc_u_summary_make_f(rast_impact, vect_crop_ISO_lc_rcl_combined)
  
  
    dB_droughtf_u_summary <-
    dB_droughtf_u_summary_make_f(rast_impact, vect_crop_ISO_lc_rcl_combined)
  
  
    dB_drought_change_u_summary <-
    dB_drought_change_u_summary_make_f(rast_impact, vect_crop_ISO_lc_rcl_combined)

```

## Drought Plots

\newpage

```{r impact_zonal_drought_plots}


  
    dB_droughtc_l_summary_plot <-
    dB_droughtc_l_summary_plot_f(dB_droughtc_l_summary, drought, ISO, crop)
  
  
    dB_droughtf_l_summary_plot <-
    dB_droughtf_l_summary_plot_f(dB_droughtf_l_summary, drought, ISO, crop)
  
  
    dB_drought_change_l_summary_plot <-
    dB_drought_change_l_summary_plot_f(dB_drought_change_l_summary, drought, ISO, crop)
  
    
    dB_droughtc_u_summary_plot <-
    dB_droughtc_u_summary_plot_f(dB_droughtc_u_summary, drought, ISO, crop)
  
  
    dB_droughtf_u_summary_plot <-
    dB_droughtf_u_summary_plot_f(dB_droughtf_u_summary, drought, ISO, crop)
  
  
    dB_drought_change_u_summary_plot <-
    dB_drought_change_u_summary_plot_f(dB_drought_change_u_summary, drought, ISO, crop)


```



```{r, message = FALSE, fig.width = 8, fig.height = 6}

 dB_droughtc_l_summary_plot

```

```{r, message = FALSE, fig.width = 8, fig.height = 6}

 dB_droughtf_l_summary_plot

```

```{r, message = FALSE, fig.width = 8, fig.height = 6}

 dB_drought_change_l_summary_plot

```

```{r, message = FALSE, fig.width = 8, fig.height = 6}

 dB_droughtc_u_summary_plot

```

```{r, message = FALSE, fig.width = 8, fig.height = 6}

 dB_droughtf_u_summary_plot

```

```{r, message = FALSE, fig.width = 8, fig.height = 6}

 dB_drought_change_u_summary_plot

```

## Heat Calculation

```{r impact_zonal_heat}


  
    dB_heatc_l_summary_values <-
    dB_heatc_l_summary_values_make_f(rast_impact, vect_crop_ISO_lc_rcl_combined)
    
  
    dB_heatc_l_summary <-
    dB_heatc_l_summary_make_f(rast_impact, vect_crop_ISO_lc_rcl_combined)
  
  
    dB_heatf_l_summary <-
    dB_heatf_l_summary_make_f(rast_impact, vect_crop_ISO_lc_rcl_combined)
  
  
    dB_heat_change_l_summary <-
    dB_heat_change_l_summary_make_f(rast_impact, vect_crop_ISO_lc_rcl_combined)
  
    
    dB_heatc_u_summary <-
    dB_heatc_u_summary_make_f(rast_impact, vect_crop_ISO_lc_rcl_combined)
  
  
    dB_heatf_u_summary <-
    dB_heatf_u_summary_make_f(rast_impact, vect_crop_ISO_lc_rcl_combined)
  
  
    dB_heat_change_u_summary <-
    dB_heat_change_u_summary_make_f(rast_impact, vect_crop_ISO_lc_rcl_combined)


```

## Heat Plots

\newpage

```{r impact_zonal_heat_plots}


  
    dB_heatc_l_summary_plot <-
    dB_heatc_l_summary_plot_f(dB_heatc_l_summary, heat, ISO, crop)
  
  
    dB_heatf_l_summary_plot <-
    dB_heatf_l_summary_plot_f(dB_heatf_l_summary, heat, ISO, crop)
  
  
    dB_heat_change_l_summary_plot <-
    dB_heat_change_l_summary_plot_f(dB_heat_change_l_summary, heat, ISO, crop)
  
    
    dB_heatc_u_summary_plot <-
    dB_heatc_u_summary_plot_f(dB_heatc_u_summary, heat, ISO, crop)
  
  
    dB_heatf_u_summary_plot <-
    dB_heatf_u_summary_plot_f(dB_heatf_u_summary, heat, ISO, crop)
  
  
    dB_heat_change_u_summary_plot <-
    dB_heat_change_u_summary_plot_f(dB_heat_change_u_summary, heat, ISO, crop)


```

```{r, message = FALSE, fig.width = 8, fig.height = 6}

 dB_heatc_l_summary

```

```{r, message = FALSE, fig.width = 8, fig.height = 6}

 dB_heatc_l_summary_plot

```

```{r, message = FALSE, fig.width = 8, fig.height = 6}

 dB_heatf_l_summary_plot

```

```{r, message = FALSE, fig.width = 8, fig.height = 6}

 dB_heat_change_l_summary_plot

```

```{r, message = FALSE, fig.width = 8, fig.height = 6}

 dB_heatc_u_summary_plot

```

```{r, message = FALSE, fig.width = 8, fig.height = 6}

 dB_heatf_u_summary_plot

```

```{r, message = FALSE, fig.width = 8, fig.height = 6}

 dB_heat_change_u_summary_plot

```

## Flood Calculation

```{r impact_zonal_flood}


  
    dB_floodc_l_summary <-
    dB_floodc_l_summary_make_f(rast_impact, vect_crop_ISO_lc_rcl_combined)
  
  
    dB_floodf_l_summary <-
    dB_floodf_l_summary_make_f(rast_impact, vect_crop_ISO_lc_rcl_combined)
  
  
    dB_flood_change_l_summary <-
    dB_flood_change_l_summary_make_f(rast_impact, vect_crop_ISO_lc_rcl_combined)
  
    
    dB_floodc_u_summary <-
    dB_floodc_u_summary_make_f(rast_impact, vect_crop_ISO_lc_rcl_combined)
  
  
    dB_floodf_u_summary <-
    dB_floodf_u_summary_make_f(rast_impact, vect_crop_ISO_lc_rcl_combined)
  
  
    dB_flood_change_u_summary <-
    dB_flood_change_u_summary_make_f(rast_impact, vect_crop_ISO_lc_rcl_combined)


```

## Flood Plots

\newpage

```{r impact_zonal_flood_plots}


  
    dB_floodc_l_summary_plot <-
    dB_floodc_l_summary_plot_f(dB_floodc_l_summary, flood, ISO, crop)
  
  
    dB_floodf_l_summary_plot <-
    dB_floodf_l_summary_plot_f(dB_floodf_l_summary, flood, ISO, crop)
  
  
    dB_flood_change_l_summary_plot <-
    dB_flood_change_l_summary_plot_f(dB_flood_change_l_summary, flood, ISO, crop)
  
    
    dB_floodc_u_summary_plot <-
    dB_floodc_u_summary_plot_f(dB_floodc_u_summary, flood, ISO, crop)
  
  
    dB_floodf_u_summary_plot <-
    dB_floodf_u_summary_plot_f(dB_floodf_u_summary, flood, ISO, crop)
  
  
    dB_flood_change_u_summary_plot <-
    dB_flood_change_u_summary_plot_f(dB_flood_change_u_summary, flood, ISO, crop)


```

```{r, message = FALSE, fig.width = 8, fig.height = 6}

 dB_floodc_l_summary_plot

```

```{r, message = FALSE, fig.width = 8, fig.height = 6}

 dB_floodf_l_summary_plot

```

```{r, message = FALSE, fig.width = 8, fig.height = 6}

 dB_flood_change_l_summary_plot

```

```{r, message = FALSE, fig.width = 8, fig.height = 6}

 dB_floodc_u_summary_plot

```

```{r, message = FALSE, fig.width = 8, fig.height = 6}

 dB_floodf_u_summary_plot

```

```{r, message = FALSE, fig.width = 8, fig.height = 6}

 dB_flood_change_u_summary_plot

```

# Climate Risk Profiles

## Prepare Climate Risk Profile Data

```{r climate_risk_profile_data_prep}


  
    dB_profile_summary <- 
    dB_profile_summary_make_f(rast_impact, vect_crop_ISO_lc_rcl_combined)
  
  
    dB_profile_summary_file <-
    dB_profile_summary_file_make_f(vect_crop_ISO_lc_rcl_combined, dB_profile_summary, ISO, crop)


```

## Plot Climate Risk Profile Data

### Past - Lower thresholds

\newpage

```{r climate_risk_profile_data_plots_c_l}


  
    dB_profilec_d_l_h_l_plot <-
    dB_profilec_d_l_h_l_plot_make_f(vect_crop_ISO_lc_rcl_combined, dB_profile_summary, ISO, crop)
  
  
    dB_profilec_d_l_f_l_plot <-
    dB_profilec_d_l_f_l_plot_make_f(vect_crop_ISO_lc_rcl_combined, dB_profile_summary, ISO, crop)
  
  
    dB_profilec_h_l_f_l_plot <-
    dB_profilec_h_l_f_l_plot_make_f(vect_crop_ISO_lc_rcl_combined, dB_profile_summary, ISO, crop)
  
    
    dB_profilec_d_l_h_l_f_l_plot <-
    dB_profilec_d_l_h_l_f_l_plot_make_f(vect_crop_ISO_lc_rcl_combined, dB_profile_summary, ISO, crop)

```

```{r, message = FALSE, fig.width = 8, fig.height = 6}

dB_profilec_d_l_h_l_plot

```

```{r, message = FALSE, fig.width = 8, fig.height = 6}

rast_droughtc_l_heatc_l_max_plot

```

```{r, message = FALSE, fig.width = 8, fig.height = 6}

dB_profilec_d_l_f_l_plot

```

```{r, message = FALSE, fig.width = 8, fig.height = 6}

rast_droughtc_l_floodc_l_max_plot

```

```{r, message = FALSE, fig.width = 8, fig.height = 6}

dB_profilec_h_l_f_l_plot

```

```{r, message = FALSE, fig.width = 8, fig.height = 6}

rast_heatc_l_floodc_l_max_plot

```

```{r, message = FALSE, fig.width = 8, fig.height = 6}


dB_profilec_d_l_h_l_f_l_plot

```

```{r, message = FALSE, fig.width = 8, fig.height = 6}

rast_droughtc_l_heatc_l_floodc_l_max_plot

```

### Past - Upper thresholds

\newpage

```{r climate_risk_profile_data_plots_c_u}


    
    dB_profilec_d_u_h_u_plot <-
    dB_profilec_d_u_h_u_plot_make_f(vect_crop_ISO_lc_rcl_combined, dB_profile_summary, ISO, crop)
  
  
    dB_profilec_d_u_f_u_plot <-
    dB_profilec_d_u_f_u_plot_make_f(vect_crop_ISO_lc_rcl_combined, dB_profile_summary, ISO, crop)
  
  
    dB_profilec_h_u_f_u_plot <-
    dB_profilec_h_u_f_u_plot_make_f(vect_crop_ISO_lc_rcl_combined, dB_profile_summary, ISO, crop)
  
    
    dB_profilec_d_u_h_u_f_u_plot <-
    dB_profilec_d_u_h_u_f_u_plot_make_f(vect_crop_ISO_lc_rcl_combined, dB_profile_summary, ISO, crop)


```

```{r, message = FALSE, fig.width = 8, fig.height = 6}

dB_profilec_d_u_h_u_plot

```

```{r, message = FALSE, fig.width = 8, fig.height = 6}

rast_droughtc_u_heatc_u_max_plot

```

```{r, message = FALSE, fig.width = 8, fig.height = 6}

dB_profilec_d_u_f_u_plot

```

```{r, message = FALSE, fig.width = 8, fig.height = 6}

rast_droughtc_u_floodc_u_max_plot

```

```{r, message = FALSE, fig.width = 8, fig.height = 6}

dB_profilec_h_u_f_u_plot

```

```{r, message = FALSE, fig.width = 8, fig.height = 6}

rast_heatc_u_floodc_u_max_plot

```

```{r, message = FALSE, fig.width = 8, fig.height = 6}

dB_profilec_d_u_h_u_f_u_plot

```

```{r, message = FALSE, fig.width = 8, fig.height = 6}

rast_droughtc_u_heatc_u_floodc_u_max_plot

```

### Past - Mixed thresholds

\newpage

```{r climate_risk_profile_data_plots_c_m}


    
    dB_profilec_d_u_h_l_plot <-
    dB_profilec_d_u_h_l_plot_make_f(vect_crop_ISO_lc_rcl_combined, dB_profile_summary, ISO, crop)
  
  
    dB_profilec_d_l_h_u_plot <-
    dB_profilec_d_l_h_u_plot_make_f(vect_crop_ISO_lc_rcl_combined, dB_profile_summary, ISO, crop)
  
  
    dB_profilec_d_u_f_l_plot <-
    dB_profilec_d_u_f_l_plot_make_f(vect_crop_ISO_lc_rcl_combined, dB_profile_summary, ISO, crop)
  
  
    dB_profilec_d_l_f_u_plot <-
    dB_profilec_d_l_f_u_plot_make_f(vect_crop_ISO_lc_rcl_combined, dB_profile_summary, ISO, crop)
  
  
    dB_profilec_h_u_f_l_plot <-
    dB_profilec_h_u_f_l_plot_make_f(vect_crop_ISO_lc_rcl_combined, dB_profile_summary, ISO, crop)
  
  
    dB_profilec_h_l_f_u_plot <-
    dB_profilec_h_l_f_u_plot_make_f(vect_crop_ISO_lc_rcl_combined, dB_profile_summary, ISO, crop)
  
    
    dB_profilec_d_u_h_l_f_l_plot <-
    dB_profilec_d_u_h_l_f_l_plot_make_f(vect_crop_ISO_lc_rcl_combined, dB_profile_summary, ISO, crop)
  
  
    dB_profilec_d_l_h_u_f_l_plot <-
    dB_profilec_d_l_h_u_f_l_plot_make_f(vect_crop_ISO_lc_rcl_combined, dB_profile_summary, ISO, crop)
  
  
    dB_profilec_d_l_h_l_f_u_plot <-
    dB_profilec_d_l_h_l_f_u_plot_make_f(vect_crop_ISO_lc_rcl_combined, dB_profile_summary, ISO, crop)
  
  
    dB_profilec_d_u_h_u_f_l_plot <-
    dB_profilec_d_u_h_u_f_l_plot_make_f(vect_crop_ISO_lc_rcl_combined, dB_profile_summary, ISO, crop)
  
  
    dB_profilec_d_u_h_l_f_u_plot <-
    dB_profilec_d_u_h_l_f_u_plot_make_f(vect_crop_ISO_lc_rcl_combined, dB_profile_summary, ISO, crop)
  
  
    dB_profilec_d_l_h_u_f_u_plot <-
    dB_profilec_d_l_h_u_f_u_plot_make_f(vect_crop_ISO_lc_rcl_combined, dB_profile_summary, ISO, crop)


```

```{r, message = FALSE, fig.width = 8, fig.height = 6}

dB_profilec_d_u_h_l_plot
```

```{r, message = FALSE, fig.width = 8, fig.height = 6}

rast_droughtc_u_heatc_l_max_plot

```

```{r, message = FALSE, fig.width = 8, fig.height = 6}
dB_profilec_d_l_h_u_plot
```

```{r, message = FALSE, fig.width = 8, fig.height = 6}

rast_droughtc_l_heatc_u_max_plot

```

```{r, message = FALSE, fig.width = 8, fig.height = 6}
dB_profilec_d_u_f_l_plot
```

```{r, message = FALSE, fig.width = 8, fig.height = 6}

rast_droughtc_u_floodc_l_max_plot

```

```{r, message = FALSE, fig.width = 8, fig.height = 6}
dB_profilec_d_l_f_u_plot
```

```{r, message = FALSE, fig.width = 8, fig.height = 6}

rast_droughtc_l_floodc_u_max_plot

```

```{r, message = FALSE, fig.width = 8, fig.height = 6}
dB_profilec_h_u_f_l_plot
```

```{r, message = FALSE, fig.width = 8, fig.height = 6}

rast_heatc_u_floodc_l_max_plot

```

```{r, message = FALSE, fig.width = 8, fig.height = 6}
dB_profilec_h_l_f_u_plot
```

```{r, message = FALSE, fig.width = 8, fig.height = 6}

rast_heatc_l_floodc_u_max_plot

```

```{r, message = FALSE, fig.width = 8, fig.height = 6}
dB_profilec_d_u_h_l_f_l_plot
```

```{r, message = FALSE, fig.width = 8, fig.height = 6}

rast_droughtc_u_heatc_l_floodc_l_max_plot

```

```{r, message = FALSE, fig.width = 8, fig.height = 6}
dB_profilec_d_l_h_u_f_l_plot
```

```{r, message = FALSE, fig.width = 8, fig.height = 6}

rast_droughtc_l_heatc_u_floodc_l_max_plot

```

```{r, message = FALSE, fig.width = 8, fig.height = 6}
dB_profilec_d_l_h_l_f_u_plot
```

```{r, message = FALSE, fig.width = 8, fig.height = 6}

rast_droughtc_l_heatc_l_floodc_u_max_plot

```

```{r, message = FALSE, fig.width = 8, fig.height = 6}
dB_profilec_d_u_h_u_f_l_plot
```

```{r, message = FALSE, fig.width = 8, fig.height = 6}

rast_droughtc_u_heatc_u_floodc_l_max_plot

```

```{r, message = FALSE, fig.width = 8, fig.height = 6}
dB_profilec_d_u_h_l_f_u_plot
```

```{r, message = FALSE, fig.width = 8, fig.height = 6}

rast_droughtc_u_heatc_l_floodc_u_max_plot

```

```{r, message = FALSE, fig.width = 8, fig.height = 6}
dB_profilec_d_l_h_u_f_u_plot

```

```{r, message = FALSE, fig.width = 8, fig.height = 6}

rast_droughtc_l_heatc_u_floodc_u_max_plot

```

### Future - Lower thresholds

\newpage

```{r climate_risk_profile_data_plots_f_l}


  
    dB_profilef_d_l_h_l_plot <-
    dB_profilef_d_l_h_l_plot_make_f(vect_crop_ISO_lc_rcl_combined, dB_profile_summary, ISO, crop)
  
  
    dB_profilef_d_l_f_l_plot <-
    dB_profilef_d_l_f_l_plot_make_f(vect_crop_ISO_lc_rcl_combined, dB_profile_summary, ISO, crop)
  
  
    dB_profilef_h_l_f_l_plot <-
    dB_profilef_h_l_f_l_plot_make_f(vect_crop_ISO_lc_rcl_combined, dB_profile_summary, ISO, crop)
  
    
    dB_profilef_d_l_h_l_f_l_plot <-
    dB_profilef_d_l_h_l_f_l_plot_make_f(vect_crop_ISO_lc_rcl_combined, dB_profile_summary, ISO, crop)

```

```{r, message = FALSE, fig.width = 8, fig.height = 6}

dB_profilef_d_l_h_l_plot

```

```{r, message = FALSE, fig.width = 8, fig.height = 6}

rast_droughtf_l_heatf_l_max_plot

```

```{r, message = FALSE, fig.width = 8, fig.height = 6}

dB_profilef_d_l_f_l_plot

```

```{r, message = FALSE, fig.width = 8, fig.height = 6}

rast_droughtf_l_floodf_l_max_plot

```

```{r, message = FALSE, fig.width = 8, fig.height = 6}

dB_profilef_h_l_f_l_plot

```

```{r, message = FALSE, fig.width = 8, fig.height = 6}

rast_heatf_l_floodf_l_max_plot

```

```{r, message = FALSE, fig.width = 8, fig.height = 6}


dB_profilef_d_l_h_l_f_l_plot

```

```{r, message = FALSE, fig.width = 8, fig.height = 6}

rast_droughtf_l_heatf_l_floodf_l_max_plot

```

### Future - Upper thresholds

\newpage

```{r climate_risk_profile_data_plots_f_u}


    
    dB_profilef_d_u_h_u_plot <-
    dB_profilef_d_u_h_u_plot_make_f(vect_crop_ISO_lc_rcl_combined, dB_profile_summary, ISO, crop)
  
  
    dB_profilef_d_u_f_u_plot <-
    dB_profilef_d_u_f_u_plot_make_f(vect_crop_ISO_lc_rcl_combined, dB_profile_summary, ISO, crop)
  
  
    dB_profilef_h_u_f_u_plot <-
    dB_profilef_h_u_f_u_plot_make_f(vect_crop_ISO_lc_rcl_combined, dB_profile_summary, ISO, crop)
  
    
    dB_profilef_d_u_h_u_f_u_plot <-
    dB_profilef_d_u_h_u_f_u_plot_make_f(vect_crop_ISO_lc_rcl_combined, dB_profile_summary, ISO, crop)


```

```{r, message = FALSE, fig.width = 8, fig.height = 6}

dB_profilef_d_u_h_u_plot

```

```{r, message = FALSE, fig.width = 8, fig.height = 6}

rast_droughtf_u_heatf_u_max_plot

```

```{r, message = FALSE, fig.width = 8, fig.height = 6}

dB_profilef_d_u_f_u_plot

```

```{r, message = FALSE, fig.width = 8, fig.height = 6}

rast_droughtf_u_floodf_u_max_plot

```

```{r, message = FALSE, fig.width = 8, fig.height = 6}

dB_profilef_h_u_f_u_plot

```

```{r, message = FALSE, fig.width = 8, fig.height = 6}

rast_heatf_u_floodf_u_max_plot

```

```{r, message = FALSE, fig.width = 8, fig.height = 6}

dB_profilef_d_u_h_u_f_u_plot

```

```{r, message = FALSE, fig.width = 8, fig.height = 6}

rast_droughtf_u_heatf_u_floodf_u_max_plot

```

### Future - Mixed thresholds

\newpage

```{r climate_risk_profile_data_plots_f_m}


    
    dB_profilef_d_u_h_l_plot <-
    dB_profilef_d_u_h_l_plot_make_f(vect_crop_ISO_lc_rcl_combined, dB_profile_summary, ISO, crop)
  
  
    dB_profilef_d_l_h_u_plot <-
    dB_profilef_d_l_h_u_plot_make_f(vect_crop_ISO_lc_rcl_combined, dB_profile_summary, ISO, crop)
  
  
    dB_profilef_d_u_f_l_plot <-
    dB_profilef_d_u_f_l_plot_make_f(vect_crop_ISO_lc_rcl_combined, dB_profile_summary, ISO, crop)
  
  
    dB_profilef_d_l_f_u_plot <-
    dB_profilef_d_l_f_u_plot_make_f(vect_crop_ISO_lc_rcl_combined, dB_profile_summary, ISO, crop)
  
  
    dB_profilef_h_u_f_l_plot <-
    dB_profilef_h_u_f_l_plot_make_f(vect_crop_ISO_lc_rcl_combined, dB_profile_summary, ISO, crop)
  
  
    dB_profilef_h_l_f_u_plot <-
    dB_profilef_h_l_f_u_plot_make_f(vect_crop_ISO_lc_rcl_combined, dB_profile_summary, ISO, crop)
  
    
    dB_profilef_d_u_h_l_f_l_plot <-
    dB_profilef_d_u_h_l_f_l_plot_make_f(vect_crop_ISO_lc_rcl_combined, dB_profile_summary, ISO, crop)
  
  
    dB_profilef_d_l_h_u_f_l_plot <-
    dB_profilef_d_l_h_u_f_l_plot_make_f(vect_crop_ISO_lc_rcl_combined, dB_profile_summary, ISO, crop)
  
  
    dB_profilef_d_l_h_l_f_u_plot <-
    dB_profilef_d_l_h_l_f_u_plot_make_f(vect_crop_ISO_lc_rcl_combined, dB_profile_summary, ISO, crop)
  
  
    dB_profilef_d_u_h_u_f_l_plot <-
    dB_profilef_d_u_h_u_f_l_plot_make_f(vect_crop_ISO_lc_rcl_combined, dB_profile_summary, ISO, crop)
  
  
    dB_profilef_d_u_h_l_f_u_plot <-
    dB_profilef_d_u_h_l_f_u_plot_make_f(vect_crop_ISO_lc_rcl_combined, dB_profile_summary, ISO, crop)
  
  
    dB_profilef_d_l_h_u_f_u_plot <-
    dB_profilef_d_l_h_u_f_u_plot_make_f(vect_crop_ISO_lc_rcl_combined, dB_profile_summary, ISO, crop)


```

```{r, message = FALSE, fig.width = 8, fig.height = 6}

dB_profilef_d_u_h_l_plot
```

```{r, message = FALSE, fig.width = 8, fig.height = 6}

rast_droughtf_u_heatf_l_max_plot

```

```{r, message = FALSE, fig.width = 8, fig.height = 6}
dB_profilef_d_l_h_u_plot
```

```{r, message = FALSE, fig.width = 8, fig.height = 6}

rast_droughtf_l_heatf_u_max_plot

```

```{r, message = FALSE, fig.width = 8, fig.height = 6}
dB_profilef_d_u_f_l_plot
```

```{r, message = FALSE, fig.width = 8, fig.height = 6}

rast_droughtf_u_floodf_l_max_plot

```

```{r, message = FALSE, fig.width = 8, fig.height = 6}
dB_profilef_d_l_f_u_plot
```

```{r, message = FALSE, fig.width = 8, fig.height = 6}

rast_droughtf_l_floodf_u_max_plot

```

```{r, message = FALSE, fig.width = 8, fig.height = 6}
dB_profilef_h_u_f_l_plot
```

```{r, message = FALSE, fig.width = 8, fig.height = 6}

rast_heatf_u_floodf_l_max_plot

```

```{r, message = FALSE, fig.width = 8, fig.height = 6}
dB_profilef_h_l_f_u_plot
```

```{r, message = FALSE, fig.width = 8, fig.height = 6}

rast_heatf_l_floodf_u_max_plot

```

```{r, message = FALSE, fig.width = 8, fig.height = 6}
dB_profilef_d_u_h_l_f_l_plot
```

```{r, message = FALSE, fig.width = 8, fig.height = 6}

rast_droughtf_u_heatf_l_floodf_l_max_plot

```

```{r, message = FALSE, fig.width = 8, fig.height = 6}
dB_profilef_d_l_h_u_f_l_plot
```

```{r, message = FALSE, fig.width = 8, fig.height = 6}

rast_droughtf_l_heatf_u_floodf_l_max_plot

```

```{r, message = FALSE, fig.width = 8, fig.height = 6}
dB_profilef_d_l_h_l_f_u_plot
```

```{r, message = FALSE, fig.width = 8, fig.height = 6}

rast_droughtf_l_heatf_l_floodf_u_max_plot

```

```{r, message = FALSE, fig.width = 8, fig.height = 6}
dB_profilef_d_u_h_u_f_l_plot
```

```{r, message = FALSE, fig.width = 8, fig.height = 6}

rast_droughtf_u_heatf_u_floodf_l_max_plot

```

```{r, message = FALSE, fig.width = 8, fig.height = 6}
dB_profilef_d_u_h_l_f_u_plot
```

```{r, message = FALSE, fig.width = 8, fig.height = 6}

rast_droughtf_u_heatf_l_floodf_u_max_plot

```

```{r, message = FALSE, fig.width = 8, fig.height = 6}
dB_profilef_d_l_h_u_f_u_plot

```

```{r, message = FALSE, fig.width = 8, fig.height = 6}

rast_droughtf_l_heatf_u_floodf_u_max_plot

```
